<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Value-Driven Discovery Tool</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(to bottom right, #f8fafc, #e2e8f0);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 50px;
    }
    
    .header h1 {
      font-size: 2.5rem;
      color: #1e293b;
      margin-bottom: 10px;
    }
    
    .header p {
      font-size: 1.1rem;
      color: #64748b;
    }
    
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .product-card {
      padding: 40px;
      border-radius: 12px;
      color: white;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .product-card:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 20px rgba(0,0,0,0.15);
    }
    
    .product-card h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }
    
    .product-card p {
      opacity: 0.9;
      font-size: 0.9rem;
    }
    
    .bg-purple { background: #904AB0; }
    .bg-blue { background: #456ED6; }
    .bg-teal { background: #26A199; }
    .bg-orange { background: #D48026; }
    
    .question-container {
      background: white;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .progress-bar {
      margin-bottom: 30px;
    }
    
    .progress-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 0.9rem;
      color: #64748b;
    }
    
    .progress-track {
      width: 100%;
      height: 8px;
      background: #e2e8f0;
      border-radius: 4px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      transition: width 0.3s;
      border-radius: 4px;
    }
    
    .category-badge {
      display: inline-block;
      padding: 8px 16px;
      background: #f1f5f9;
      color: #475569;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 500;
      margin-bottom: 20px;
    }
    
    .question-title {
      font-size: 1.5rem;
      color: #1e293b;
      margin-bottom: 15px;
      line-height: 1.4;
    }
    
    .follow-up {
      font-style: italic;
      color: #64748b;
      margin-bottom: 30px;
      line-height: 1.6;
    }
    
    .options {
      margin-bottom: 40px;
    }
    
    .option-button {
      width: 100%;
      padding: 20px;
      margin-bottom: 12px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      background: white;
      color: #475569;
      font-size: 1rem;
      cursor: pointer;
      text-align: left;
      transition: all 0.2s;
    }
    
    .option-button:hover {
      border-color: #cbd5e1;
      background: #f8fafc;
    }
    
    .option-button.selected {
      color: white;
      border-color: transparent;
    }
    
    .navigation {
      display: flex;
      justify-content: space-between;
    }
    
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-secondary {
      background: white;
      color: #475569;
      border: 2px solid #cbd5e1;
    }
    
    .btn-secondary:hover:not(:disabled) {
      background: #f8fafc;
    }
    
    .btn-primary {
      color: white;
    }
    
    .btn-primary:hover:not(:disabled) {
      opacity: 0.9;
    }
    
    .results-container {
      background: white;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .results-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 40px;
    }
    
    .results-title h1 {
      font-size: 2rem;
      color: #1e293b;
      margin-bottom: 5px;
    }
    
    .results-title p {
      color: #64748b;
    }
    
    .btn-reset {
      padding: 12px 24px;
      background: #475569;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    
    .btn-reset:hover {
      background: #334155;
    }
    
    .scores-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .score-card {
      padding: 24px;
      border-radius: 8px;
      border: 2px solid;
    }
    
    .score-card.low {
      background: #f0fdf4;
      border-color: #86efac;
      color: #166534;
    }
    
    .score-card.medium {
      background: #fefce8;
      border-color: #fde047;
      color: #854d0e;
    }
    
    .score-card.high {
      background: #fef2f2;
      border-color: #fca5a5;
      color: #991b1b;
    }
    
    .score-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 15px;
    }
    
    .score-header h3 {
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    .impact-badge {
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 500;
      background: rgba(255,255,255,0.5);
    }
    
    .score-value {
      margin-bottom: 15px;
      font-weight: 500;
    }
    
    .talking-point {
      font-size: 0.9rem;
      line-height: 1.6;
    }
    
    .answers-section {
      background: #f8fafc;
      padding: 30px;
      border-radius: 8px;
    }
    
    .answers-section h2 {
      font-size: 1.3rem;
      color: #1e293b;
      margin-bottom: 20px;
    }
    
    .answer-item {
      background: white;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 12px;
    }
    
    .answer-question {
      font-size: 0.9rem;
      color: #64748b;
      margin-bottom: 8px;
    }
    
    .answer-value {
      color: #1e293b;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .checkmark {
      color: #22c55e;
      font-weight: bold;
    }
    
    .hidden {
      display: none;
    }
    
    .question-list-item {
      background: #f8fafc;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }
    
    .question-list-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 15px;
    }
    
    .question-list-number {
      background: #3b82f6;
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 0.9rem;
    }
    
    .question-list-category {
      padding: 4px 12px;
      background: #f1f5f9;
      color: #475569;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 500;
    }
    
    .question-list-title {
      font-size: 1.1rem;
      color: #1e293b;
      margin-bottom: 10px;
      font-weight: 600;
    }
    
    .question-list-followup {
      font-size: 0.9rem;
      color: #64748b;
      font-style: italic;
      margin-bottom: 15px;
    }
    
    .question-list-options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .list-option-button {
      padding: 12px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      background: white;
      color: #475569;
      font-size: 0.95rem;
      cursor: pointer;
      text-align: left;
      transition: all 0.2s;
    }
    
    .list-option-button:hover {
      border-color: #cbd5e1;
      background: #f8fafc;
    }
    
    .list-option-button.selected {
      border-color: transparent;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="productSelection">
      <div class="header">
        <h1>Value-Driven Discovery</h1>
        <p>Select a product to begin guided discovery</p>
      </div>
      
      <div class="product-grid">
        <div class="product-card bg-purple" id="visitor-card">
          <h3>Visitor Management</h3>
          <p id="visitor-count"></p>
        </div>
        <div class="product-card bg-orange" id="workplace-card">
          <h3>Workplace Management</h3>
          <p id="workplace-count"></p>
        </div>
        <div class="product-card bg-blue" id="asset-card">
          <h3>Asset Management</h3>
          <p id="asset-count"></p>
        </div>
        <div class="product-card bg-teal" id="engage-card">
          <h3>Employee Engagement</h3>
          <p id="engage-count"></p>
        </div>
      </div>
    </div>

    <div id="questionView" class="hidden">
      <div class="question-container">
        <div class="view-toggle" style="margin-bottom: 20px; text-align: center;">
          <button class="btn btn-secondary" id="toggleViewBtn" style="margin: 0 auto;">
            Switch to List View
          </button>
        </div>

        <div id="stepByStepView">
          <div class="progress-bar">
            <div class="progress-info">
              <span id="progressText"></span>
              <span id="productName"></span>
            </div>
            <div class="progress-track">
              <div id="progressFill" class="progress-fill"></div>
            </div>
          </div>

          <div id="categoryNavigation" style="margin-bottom: 25px; padding: 20px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
            <div style="font-size: 0.85rem; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; margin-bottom: 12px;">Jump to Category</div>
            <div id="categoryButtons" style="display: flex; flex-wrap: wrap; gap: 8px;"></div>
          </div>

          <div class="category-header" id="categoryHeader" style="margin-bottom: 20px; padding: 15px; background: #f8fafc; border-left: 4px solid #3b82f6; border-radius: 4px;">
            <div style="font-size: 0.85rem; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Category</div>
            <div id="categoryHeaderTitle" style="font-size: 1.1rem; color: #1e293b; font-weight: 600; margin-top: 4px;"></div>
          </div>

          <div class="category-badge" id="categoryBadge"></div>
          <h2 class="question-title" id="questionTitle"></h2>
          <p class="follow-up" id="followUp"></p>
          
          <div class="options" id="optionsContainer"></div>

          <div class="navigation">
            <button class="btn btn-secondary" id="prevBtn">
              ‚Üê Previous
            </button>
            <button class="btn btn-primary" id="nextBtn" disabled>
              Next ‚Üí
            </button>
          </div>
        </div>

        <div id="listView" class="hidden">
          <div style="margin-bottom: 20px;">
            <h2 style="color: #1e293b; margin-bottom: 10px;">All Questions</h2>
            <p style="color: #64748b;" id="listProductName"></p>
          </div>
          <div id="allQuestionsContainer"></div>
          <div style="margin-top: 30px; text-align: center;">
            <button class="btn btn-primary" id="submitAllBtn" style="margin: 0 auto;">
              View Results ‚Üí
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="resultsView" class="hidden">
      <div class="results-container">
        <div class="results-header">
          <div class="results-title">
            <h1>Discovery Results</h1>
            <p id="resultsProduct"></p>
          </div>
          <div style="display: flex; gap: 10px;">
            <button class="btn-reset" id="downloadPdfBtn" style="background: #3b82f6;">Download PDF</button>
            <button class="btn-reset" id="resetBtn">Start Over</button>
          </div>
        </div>

        <div class="scores-grid" id="scoresGrid"></div>

        <div id="recommendationsSection" class="answers-section" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border: 2px solid #0ea5e9; margin-bottom: 30px;">
          <h2 style="color: #0c4a6e; display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
            üí° Recommended Next Steps
          </h2>
          <p style="color: #075985; margin-bottom: 20px; font-size: 0.95rem;">
            Based on the pain points identified, consider running discovery on these additional solutions:
          </p>
          <div id="recommendationsContainer"></div>
        </div>

        <div class="answers-section">
          <h2>üìã Your Answers</h2>
          <div id="answersContainer"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    var state = {
      currentProduct: null,
      currentStep: 0,
      answers: {},
      filteredQuestions: [],
      viewMode: 'step'
    };

    var products = {
      visitor: { name: 'Visitor Management', color: '#904AB0' },
      workplace: { name: 'Workplace Management', color: '#D48026' },
      asset: { name: 'Asset Management', color: '#456ED6' },
      engage: { name: 'Employee Engagement', color: '#26A199' }
    };

    var questions = [
      {
        id: 'nda_collection',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'How consistently are NDA forms being collected and signed before check-in?',
        followUp: 'How does inconsistent NDA collection impact legal exposure or partner trust?',
        options: ['under 10%', 'under 50%', 'over 50%'],
        scoreMap: { 'under 10%': 1, 'under 50%': 2, 'over 50%': 3 }
      },
      {
        id: 'nda_compliance',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'What is our NDA compliance rate across teams or locations?',
        followUp: 'What is the business risk of low NDA compliance across teams or locations?',
        options: ['under 10%', 'under 50%', 'over 50%'],
        scoreMap: { 'under 10%': 1, 'under 50%': 2, 'over 50%': 3 }
      },
      {
        id: 'guest_reporting',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'How long does it take to generate guest reports, and what delays are common?',
        followUp: 'How do delays in guest reporting affect audit readiness or incident response?',
        options: ['under 10%', 'under 50%', 'over 50%'],
        scoreMap: { 'under 10%': 1, 'under 50%': 2, 'over 50%': 3 }
      },
      {
        id: 'evacuation_lists',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'Are evacuation lists current and inclusive of all relevant personnel?',
        followUp: 'What is the operational risk if evacuation lists are outdated or incomplete?',
        options: ['yes', 'sometimes', 'no'],
        scoreMap: { 'yes': 1, 'sometimes': 2, 'no': 3 }
      },
      {
        id: 'audit_success',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'How successful are we in passing compliance audits, and what risks are we mitigating?',
        followUp: 'What is the business impact of audit performance in terms of financial exposure, operational disruption, or reputational risk?',
        options: ['under 10%', 'under 50%', 'over 50%'],
        scoreMap: { 'under 10%': 1, 'under 50%': 2, 'over 50%': 3 }
      },
      {
        id: 'meeting_alignment',
        product: 'visitor',
        category: 'Employee Experience',
        question: 'How often do booking conflicts occur, and what is driving them?',
        followUp: 'How does misaligned meeting attendance affect productivity or decision-making?',
        options: ['Never', 'half', 'often'],
        scoreMap: { 'Never': 1, 'half': 2, 'often': 3 }
      },
      {
        id: 'booking_conflicts',
        product: 'visitor',
        category: 'Decision Making Clarity',
        question: 'How accurate is our occupancy data compared to actual usage?',
        options: ['under 10%', 'under 50%', 'over 50%'],
        scoreMap: { 'under 10%': 1, 'under 50%': 2, 'over 50%': 3 }
      },
      {
        id: 'brand_impression',
        product: 'visitor',
        category: 'Employee Experience',
        question: 'How closely aligned is your current visitor experience to your Brand representation?',
        followUp: 'How well does your current visitor experience reflect your brand values and expectations?',
        options: ['spot on', 'close', 'terrible'],
        scoreMap: { 'spot on': 1, 'close': 2, 'terrible': 3 }
      },
      {
        id: 'unauthorized_access',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'How many unauthorized access incidents or security breaches have you experienced in the past year?',
        followUp: 'What is the potential impact of unauthorized visitor access on your operations and security?',
        options: ['none or 1-2', '3-5 incidents', 'more than 5'],
        scoreMap: { 'none or 1-2': 1, '3-5 incidents': 2, 'more than 5': 3 }
      },
      {
        id: 'pre_registration_rate',
        product: 'visitor',
        category: 'Operational Efficiency',
        question: 'What percentage of your visitors pre-register before arrival?',
        followUp: 'How does low pre-registration impact wait times and receptionist workload?',
        options: ['over 60%', '30-60%', 'under 30%'],
        scoreMap: { 'over 60%': 1, '30-60%': 2, 'under 30%': 3 }
      },
      {
        id: 'check_in_time',
        product: 'visitor',
        category: 'Employee Experience',
        question: 'What percentage of visitors complete check-in in under 2 minutes?',
        followUp: 'How do long wait times affect visitor satisfaction and your brand impression?',
        options: ['over 80%', '50-80%', 'under 50%'],
        scoreMap: { 'over 80%': 1, '50-80%': 2, 'under 50%': 3 }
      },
      {
        id: 'self_service_adoption',
        product: 'visitor',
        category: 'Operational Efficiency',
        question: 'What percentage of visitors use self-service check-in like kiosks or QR codes?',
        followUp: 'How much receptionist time could be saved with higher self-service adoption?',
        options: ['over 50%', '25-50%', 'under 25%'],
        scoreMap: { 'over 50%': 1, '25-50%': 2, 'under 25%': 3 }
      },
      {
        id: 'visitor_nps',
        product: 'visitor',
        category: 'Employee Experience',
        question: 'What is your visitor satisfaction score or NPS?',
        followUp: 'How does visitor experience quality impact your reputation with clients and partners?',
        options: ['high or positive', 'neutral', 'low or negative'],
        scoreMap: { 'high or positive': 1, 'neutral': 2, 'low or negative': 3 }
      },
      {
        id: 'watchlist_screening',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'Do you currently screen visitors against watchlists or blocked lists?',
        followUp: 'What is the risk of not identifying blocked or high-risk visitors before entry?',
        options: ['yes always', 'sometimes', 'no'],
        scoreMap: { 'yes always': 1, 'sometimes': 2, 'no': 3 }
      },
      {
        id: 'manual_receptionist_work',
        product: 'visitor',
        category: 'Operational Efficiency',
        question: 'How much time does your reception staff spend on manual visitor check-in per day?',
        followUp: 'What productivity gains could you achieve by reducing manual entry and paperwork?',
        options: ['under 2 hours', '2-4 hours', 'over 4 hours'],
        scoreMap: { 'under 2 hours': 1, '2-4 hours': 2, 'over 4 hours': 3 }
      },
      {
        id: 'host_notifications',
        product: 'visitor',
        category: 'Employee Experience',
        question: 'Do hosts receive real-time notifications when their visitors arrive?',
        followUp: 'How does delayed host awareness impact visitor experience and meeting efficiency?',
        options: ['yes automatic', 'sometimes manual', 'no'],
        scoreMap: { 'yes automatic': 1, 'sometimes manual': 2, 'no': 3 }
      },
      {
        id: 'calendar_integration',
        product: 'visitor',
        category: 'Operational Efficiency',
        question: 'What percentage of visitor appointments are linked to calendar invites or meetings?',
        followUp: 'How could calendar integration streamline visitor management in a hybrid work environment?',
        options: ['over 60%', '30-60%', 'under 30%'],
        scoreMap: { 'over 60%': 1, '30-60%': 2, 'under 30%': 3 }
      },
      {
        id: 'multilingual_support',
        product: 'visitor',
        category: 'Employee Experience',
        question: 'Do you offer check-in instructions in multiple languages for international visitors?',
        followUp: 'How does language barriers impact visitor experience and check-in efficiency?',
        options: ['yes multiple languages', 'limited', 'english only'],
        scoreMap: { 'yes multiple languages': 1, 'limited': 2, 'english only': 3 }
      },
      {
        id: 'audit_trail',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'How quickly can you generate audit reports for visitor activity and compliance?',
        followUp: 'What is the cost of poor audit trails during compliance reviews or investigations?',
        options: ['instantly automated', 'hours or days', 'manual and slow'],
        scoreMap: { 'instantly automated': 1, 'hours or days': 2, 'manual and slow': 3 }
      },
      {
        id: 'access_control_integration',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'Is your visitor management system integrated with access control systems?',
        followUp: 'How does lack of integration create security gaps and manual overhead?',
        options: ['yes fully integrated', 'partially', 'no integration'],
        scoreMap: { 'yes fully integrated': 1, 'partially': 2, 'no integration': 3 }
      },
      {
        id: 'tailgating_incidents',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'How many tailgating incidents occur monthly?',
        followUp: 'What is the cost‚Äîfinancial or reputational‚Äîof tailgating incidents and how are they mitigated?',
        options: ['none', 'under 5', 'over 10'],
        scoreMap: { 'none': 1, 'under 5': 2, 'over 10': 3 }
      },
      {
        id: 'emergency_communication',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'Are you able to communicate with visitors during an emergency?',
        followUp: 'How confident are you in reaching and guiding visitors during a critical event and what is at stake if communication fails?',
        options: ['yes with system', 'manual process', 'no capability'],
        scoreMap: { 'yes with system': 1, 'manual process': 2, 'no capability': 3 }
      },
      {
        id: 'flagged_visitors',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'How many visitors are flagged during check-in or screening?',
        followUp: 'What protocols are in place when a flagged visitor is identified and how do they affect response time or liability?',
        options: ['none', 'under 5 per month', 'over 10 per month'],
        scoreMap: { 'none': 1, 'under 5 per month': 2, 'over 10 per month': 3 }
      },
      {
        id: 'badge_compliance_rate',
        product: 'visitor',
        category: 'Security & Compliance',
        question: 'What is your badge compliance rate for visitors?',
        followUp: 'What is the business impact of unauthorized access in terms of risk, compliance, or operational disruption?',
        options: ['over 95%', '85-95%', 'under 85%'],
        scoreMap: { 'over 95%': 1, '85-95%': 2, 'under 85%': 3 }
      },
      {
        id: 'self_checkin_qr_usage',
        product: 'visitor',
        category: 'Operational Efficiency',
        question: 'How many visitors use self-check-in QR codes?',
        followUp: 'How does self-check-in influence throughput, staffing needs, or visitor satisfaction and what is the ROI?',
        options: ['over 50%', '25-50%', 'under 25%'],
        scoreMap: { 'over 50%': 1, '25-50%': 2, 'under 25%': 3 }
      },
      {
        id: 'visitor_sso_requirement',
        product: 'visitor',
        category: 'Implementation & Professional Services',
        question: 'Do you require Single Sign-On (SSO) integration for visitor management?',
        followUp: 'What authentication systems do you currently use?',
        options: ['yes required', 'preferred', 'not needed'],
        scoreMap: { 'yes required': 3, 'preferred': 2, 'not needed': 1 }
      },
      {
        id: 'visitor_acs_integration',
        product: 'visitor',
        category: 'Implementation & Professional Services',
        question: 'Do you need Access Control System (ACS) integration with visitor management?',
        followUp: 'What ACS system do you currently use?',
        options: ['yes required', 'exploring', 'not needed'],
        scoreMap: { 'yes required': 3, 'exploring': 2, 'not needed': 1 }
      },
      {
        id: 'visitor_api_access',
        product: 'visitor',
        category: 'Implementation & Professional Services',
        question: 'Do you need API access for custom integrations or data export?',
        followUp: 'What systems need to integrate with visitor management?',
        options: ['yes required', 'maybe', 'not needed'],
        scoreMap: { 'yes required': 3, 'maybe': 2, 'not needed': 1 }
      },
      {
        id: 'visitor_wifi_integration',
        product: 'visitor',
        category: 'Implementation & Professional Services',
        question: 'Do you need Wi-Fi provisioning integration for guest network access?',
        followUp: 'How do visitors currently get Wi-Fi access?',
        options: ['yes required', 'nice to have', 'not needed'],
        scoreMap: { 'yes required': 3, 'nice to have': 2, 'not needed': 1 }
      },
      {
        id: 'visitor_training_needs',
        product: 'visitor',
        category: 'Implementation & Professional Services',
        question: 'What level of training do you need for visitor management?',
        followUp: 'How many administrators and front desk staff need training?',
        options: ['comprehensive training', 'admin only', 'self-service'],
        scoreMap: { 'comprehensive training': 3, 'admin only': 2, 'self-service': 1 }
      },
      {
        id: 'visitor_workflow_customization',
        product: 'visitor',
        category: 'Implementation & Professional Services',
        question: 'Do you need custom visitor workflows or business rules configuration?',
        followUp: 'What unique visitor types or approval processes do you have?',
        options: ['complex customization', 'some customization', 'standard workflows'],
        scoreMap: { 'complex customization': 3, 'some customization': 2, 'standard workflows': 1 }
      },
      {
        id: 'collaboration_frequency',
        product: 'workplace',
        category: 'Decision-Making Clarity',
        question: 'How frequently do teams collaborate in person each month?',
        followUp: 'Where are we losing availability due to booking misuse and how can we reclaim space for active use?',
        options: ['multiple times per week', 'weekly', 'bi-weekly or less'],
        scoreMap: { 'multiple times per week': 1, 'weekly': 2, 'bi-weekly or less': 3 }
      },
      {
        id: 'real_estate_cost_per_sqft',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'What is your current real estate cost per square foot annually?',
        followUp: 'How much could be saved by identifying and acting on underutilized space?',
        options: ['under $30', '$30-$40', 'over $40'],
        scoreMap: { 'under $30': 1, '$30-$40': 2, 'over $40': 3 }
      },
      {
        id: 'space_utilization_rate',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'What is your overall space utilization rate across your portfolio?',
        followUp: 'What percentage of unused space could be repurposed or subleased for cost savings?',
        options: ['over 70%', '50-70%', 'under 50%'],
        scoreMap: { 'over 70%': 1, '50-70%': 2, 'under 50%': 3 }
      },
      {
        id: 'underutilized_space_identification',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'Can you quickly identify underutilized areas for consolidation or redesign?',
        followUp: 'What portfolio optimization opportunities are being missed without this visibility?',
        options: ['yes with data', 'manual analysis', 'no visibility'],
        scoreMap: { 'yes with data': 1, 'manual analysis': 2, 'no visibility': 3 }
      },
      {
        id: 'energy_waste_alignment',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'Are your HVAC and lighting systems aligned with actual space occupancy?',
        followUp: 'How much energy cost could be saved by aligning systems with real usage data?',
        options: ['yes aligned', 'partially', 'no alignment'],
        scoreMap: { 'yes aligned': 1, 'partially': 2, 'no alignment': 3 }
      },
      {
        id: 'cleaning_cost_optimization',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'Do you optimize cleaning schedules based on floor utilization data?',
        followUp: 'How much could be saved by closing off under-occupied floors on specific days?',
        options: ['yes optimized', 'exploring', 'no optimization'],
        scoreMap: { 'yes optimized': 1, 'exploring': 2, 'no optimization': 3 }
      },
      {
        id: 'departmental_chargeback',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'Do you implement departmental chargebacks based on space occupancy?',
        followUp: 'How could clear cost allocation drive accountability and reduce dead space?',
        options: ['yes implemented', 'planning', 'no chargebacks'],
        scoreMap: { 'yes implemented': 1, 'planning': 2, 'no chargebacks': 3 }
      },
      {
        id: 'service_request_cost',
        product: 'workplace',
        category: 'Operational Efficiency',
        question: 'What is your average cost per service request?',
        followUp: 'How much could be saved by automating service request workflows?',
        options: ['under $10', '$10-$20', 'over $20'],
        scoreMap: { 'under $10': 1, '$10-$20': 2, 'over $20': 3 }
      },
      {
        id: 'service_request_volume',
        product: 'workplace',
        category: 'Operational Efficiency',
        question: 'Have you reduced unnecessary service request volume through automation?',
        followUp: 'What efficiency gains could come from a 30% reduction in request volume?',
        options: ['yes reduced', 'some progress', 'no reduction'],
        scoreMap: { 'yes reduced': 1, 'some progress': 2, 'no reduction': 3 }
      },
      {
        id: 'sla_compliance',
        product: 'workplace',
        category: 'Operational Efficiency',
        question: 'What is your SLA compliance rate for service requests?',
        followUp: 'How does poor SLA performance impact employee experience and satisfaction?',
        options: ['over 95%', '85-95%', 'under 85%'],
        scoreMap: { 'over 95%': 1, '85-95%': 2, 'under 85%': 3 }
      },
      {
        id: 'preventative_maintenance',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'What percentage of your maintenance is preventative vs reactive?',
        followUp: 'How much could be saved by increasing scheduled preventative maintenance?',
        options: ['over 70% preventative', '50-70%', 'under 50%'],
        scoreMap: { 'over 70% preventative': 1, '50-70%': 2, 'under 50%': 3 }
      },
      {
        id: 'vendor_invoice_tracking',
        product: 'workplace',
        category: 'Operational Efficiency',
        question: 'How do you currently track vendor invoices and maintenance dates?',
        followUp: 'What time and risk could be saved with automated tracking and reporting?',
        options: ['automated system', 'partial automation', 'manual excel'],
        scoreMap: { 'automated system': 1, 'partial automation': 2, 'manual excel': 3 }
      },
      {
        id: 'hybrid_space_booking',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'What percentage of available spaces are actually booked in your hybrid environment?',
        followUp: 'How could dynamic reservations maximize efficiency in hybrid work?',
        options: ['over 60%', '40-60%', 'under 40%'],
        scoreMap: { 'over 60%': 1, '40-60%': 2, 'under 40%': 3 }
      },
      {
        id: 'no_show_rate',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'What is your no-show rate for meeting rooms and desk reservations?',
        followUp: 'How much wasted space could be reclaimed through auto-release or auto-cancellation?',
        options: ['under 10%', '10-15%', 'over 15%'],
        scoreMap: { 'under 10%': 1, '10-15%': 2, 'over 15%': 3 }
      },
      {
        id: 'workspace_satisfaction',
        product: 'workplace',
        category: 'Employee Experience',
        question: 'What is your employee satisfaction score for workspace access and booking?',
        followUp: 'How does workspace frustration impact retention and engagement?',
        options: ['high satisfaction', 'neutral', 'low satisfaction'],
        scoreMap: { 'high satisfaction': 1, 'neutral': 2, 'low satisfaction': 3 }
      },
      {
        id: 'booking_lead_time',
        product: 'workplace',
        category: 'Employee Experience',
        question: 'Do employees struggle to find available spaces when they come to the office?',
        followUp: 'How could better lead time booking rules reduce space availability frustration?',
        options: ['rarely an issue', 'sometimes', 'frequent problem'],
        scoreMap: { 'rarely an issue': 1, 'sometimes': 2, 'frequent problem': 3 }
      },
      {
        id: 'desk_attributes',
        product: 'workplace',
        category: 'Employee Experience',
        question: 'Have you identified which desk attributes drive highest utilization?',
        followUp: 'How could replicating popular desk features improve underutilized space?',
        options: ['yes identified', 'analyzing', 'no data'],
        scoreMap: { 'yes identified': 1, 'analyzing': 2, 'no data': 3 }
      },
      {
        id: 'midweek_capacity',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'Do you experience over-capacity on mid-week days like Tuesday-Thursday?',
        followUp: 'How could departmental scheduling rules flatten the mid-week hump?',
        options: ['managed well', 'some issues', 'major problem'],
        scoreMap: { 'managed well': 1, 'some issues': 2, 'major problem': 3 }
      },
      {
        id: 'reservation_speed',
        product: 'workplace',
        category: 'Employee Experience',
        question: 'How quickly can employees schedule space reservations in your current system?',
        followUp: 'What productivity time is lost due to slow or complex reservation processes?',
        options: ['under 2 minutes', '2-5 minutes', 'over 5 minutes'],
        scoreMap: { 'under 2 minutes': 1, '2-5 minutes': 2, 'over 5 minutes': 3 }
      },
      {
        id: 'sensor_no_show_tracking',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'Do you use sensors to track actual room usage vs bookings?',
        followUp: 'How could sensor data optimize auto-cancel procedures and reduce frustrations?',
        options: ['yes with sensors', 'planning', 'no sensors'],
        scoreMap: { 'yes with sensors': 1, 'planning': 2, 'no sensors': 3 }
      },
      {
        id: 'weekly_utilization_visibility',
        product: 'workplace',
        category: 'Decision-Making Clarity',
        question: 'Can you see utilization patterns by day of the week to inform RTO strategy?',
        followUp: 'What ROI value comes from making data-driven RTO decisions?',
        options: ['yes clear visibility', 'limited data', 'no visibility'],
        scoreMap: { 'yes clear visibility': 1, 'limited data': 2, 'no visibility': 3 }
      },
      {
        id: 'paper_waste_reduction',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'Have you reduced paper consumption through digital service request processing?',
        followUp: 'What sustainability and cost benefits come from digitizing manual processes?',
        options: ['yes reduced', 'some progress', 'still manual'],
        scoreMap: { 'yes reduced': 1, 'some progress': 2, 'still manual': 3 }
      },
      {
        id: 'desk_refurbish_cost',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'How much do you spend on getting hotel desks ready for the next occupant?',
        followUp: 'What is your process for readying desks and how does it impact utilization costs?',
        options: ['under $5', '$5-$15', 'over $20'],
        scoreMap: { 'under $5': 1, '$5-$15': 2, 'over $20': 3 }
      },
      {
        id: 'host_responsiveness',
        product: 'workplace',
        category: 'Employee Experience',
        question: 'How responsive are hosts to guest arrivals or meeting requests?',
        followUp: 'How does host responsiveness impact visitor and employee experience?',
        options: ['very responsive', 'limited by workload', 'poor responsiveness'],
        scoreMap: { 'very responsive': 1, 'limited by workload': 2, 'poor responsiveness': 3 }
      },
      {
        id: 'popular_office_day',
        product: 'workplace',
        category: 'Employee Experience',
        question: 'What is the most popular day for employees to come into the office?',
        followUp: 'How can understanding peak days help optimize resource allocation and capacity?',
        options: ['evenly distributed', 'mid-week peak', 'unclear pattern'],
        scoreMap: { 'evenly distributed': 1, 'mid-week peak': 2, 'unclear pattern': 3 }
      },
      {
        id: 'pages_printed_reduction',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'How many pages are printed before and after implementing digital service requests?',
        followUp: 'What cost and sustainability benefits come from reducing paper consumption?',
        options: ['significant reduction', 'some reduction', 'no change'],
        scoreMap: { 'significant reduction': 1, 'some reduction': 2, 'no change': 3 }
      },
      {
        id: 'service_request_turnaround',
        product: 'workplace',
        category: 'Operational Efficiency',
        question: 'How much time does a service request take from start to completion?',
        followUp: 'How could faster turnaround improve employee satisfaction and productivity?',
        options: ['under 4 hours', '4-24 hours', 'over 24 hours'],
        scoreMap: { 'under 4 hours': 1, '4-24 hours': 2, 'over 24 hours': 3 }
      },
      {
        id: 'preventative_vs_reactive_maintenance',
        product: 'workplace',
        category: 'Operational Efficiency',
        question: 'What percentage of office maintenance is preventative vs reactive?',
        followUp: 'How much could be saved by shifting from reactive to preventative maintenance?',
        options: ['mostly preventative', 'balanced', 'mostly reactive'],
        scoreMap: { 'mostly preventative': 1, 'balanced': 2, 'mostly reactive': 3 }
      },
      {
        id: 'ticket_open_duration',
        product: 'workplace',
        category: 'Operational Efficiency',
        question: 'How long do service tickets remain open on average, and is that improving?',
        followUp: 'What impact does ticket resolution speed have on employee experience?',
        options: ['under 24 hours', '1-3 days', 'over 3 days'],
        scoreMap: { 'under 24 hours': 1, '1-3 days': 2, 'over 3 days': 3 }
      },
      {
        id: 'booking_vs_available',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'What percentage of spaces are booked vs available?',
        followUp: 'How could better visibility into availability improve booking efficiency?',
        options: ['over 60% booked', '40-60%', 'under 40%'],
        scoreMap: { 'over 60% booked': 1, '40-60%': 2, 'under 40%': 3 }
      },
      {
        id: 'visitor_employee_ratio',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'What is your visitor-to-employee ratio, and how does it vary by day?',
        followUp: 'How does visitor traffic impact space planning and resource allocation?',
        options: ['well understood', 'some data', 'no tracking'],
        scoreMap: { 'well understood': 1, 'some data': 2, 'no tracking': 3 }
      },
      {
        id: 'portfolio_cost_per_meter',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'What is your portfolio cost per square meter, and how does it vary by site?',
        followUp: 'How can site-level cost data inform consolidation and lease decisions?',
        options: ['tracked by site', 'aggregate only', 'not tracked'],
        scoreMap: { 'tracked by site': 1, 'aggregate only': 2, 'not tracked': 3 }
      },
      {
        id: 'cost_per_sqft_benchmark',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'What is your cost per square foot, and how does it compare to industry benchmarks?',
        followUp: 'Where are you overpaying relative to benchmarks and what can be optimized?',
        options: ['at or below benchmark', 'slightly above', 'significantly above'],
        scoreMap: { 'at or below benchmark': 1, 'slightly above': 2, 'significantly above': 3 }
      },
      {
        id: 'repurposing_costs',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'What are the costs associated with repurposing underutilized space?',
        followUp: 'How do repurposing costs compare to ongoing waste from unused space?',
        options: ['well understood', 'rough estimates', 'unknown'],
        scoreMap: { 'well understood': 1, 'rough estimates': 2, 'unknown': 3 }
      },
      {
        id: 'energy_occupancy_correlation',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'How does energy usage correlate with occupancy trends?',
        followUp: 'What energy savings could be achieved by aligning systems with occupancy?',
        options: ['strongly correlated', 'some correlation', 'no correlation'],
        scoreMap: { 'strongly correlated': 1, 'some correlation': 2, 'no correlation': 3 }
      },
      {
        id: 'floor_utilization_cleaning',
        product: 'workplace',
        category: 'Cost Savings',
        question: 'How does floor utilization relate to cleaning costs?',
        followUp: 'How much could be saved by adjusting cleaning based on actual usage?',
        options: ['optimized cleaning', 'some optimization', 'not optimized'],
        scoreMap: { 'optimized cleaning': 1, 'some optimization': 2, 'not optimized': 3 }
      },
      {
        id: 'sqft_per_department',
        product: 'workplace',
        category: 'Space Utilization',
        question: 'How much square footage is occupied per department?',
        followUp: 'How can departmental space allocation drive accountability and efficiency?',
        options: ['tracked per dept', 'estimated', 'not tracked'],
        scoreMap: { 'tracked per dept': 1, 'estimated': 2, 'not tracked': 3 }
      },
      {
        id: 'sla_compliance_service',
        product: 'workplace',
        category: 'Operational Efficiency',
        question: 'What is your SLA compliance rate for service delivery?',
        followUp: 'How does SLA performance impact employee satisfaction and retention?',
        options: ['over 95%', '85-95%', 'under 85%'],
        scoreMap: { 'over 95%': 1, '85-95%': 2, 'under 85%': 3 }
      },
      {
        id: 'reporting_time_saved',
        product: 'workplace',
        category: 'Operational Efficiency',
        question: 'How much time is saved on reporting with automated systems vs manual processes?',
        followUp: 'What strategic work could be done with reclaimed reporting time?',
        options: ['significant time saved', 'some time saved', 'still manual'],
        scoreMap: { 'significant time saved': 1, 'some time saved': 2, 'still manual': 3 }
      },
      {
        id: 'workplace_modules_needed',
        product: 'workplace',
        category: 'Implementation & Professional Services',
        question: 'Which workplace modules do you need: Space, Move, Reservation, Service Request, Office Asset?',
        followUp: 'What are your top 3 priorities for workplace management?',
        options: ['need all modules', 'need 3-4 modules', 'need 1-2 modules'],
        scoreMap: { 'need all modules': 3, 'need 3-4 modules': 2, 'need 1-2 modules': 1 }
      },
      {
        id: 'workplace_exchange_integration',
        product: 'workplace',
        category: 'Implementation & Professional Services',
        question: 'Do you need Microsoft Exchange or Google Calendar integration?',
        followUp: 'What calendar system does your organization use?',
        options: ['yes required', 'exploring', 'not needed'],
        scoreMap: { 'yes required': 3, 'exploring': 2, 'not needed': 1 }
      },
      {
        id: 'workplace_badge_integration',
        product: 'workplace',
        category: 'Implementation & Professional Services',
        question: 'Do you need badge system integration for occupancy tracking?',
        followUp: 'What badge or access control system do you use?',
        options: ['yes required', 'interested', 'not needed'],
        scoreMap: { 'yes required': 3, 'interested': 2, 'not needed': 1 }
      },
      {
        id: 'workplace_sensor_integration',
        product: 'workplace',
        category: 'Implementation & Professional Services',
        question: 'Do you need sensor integration for real-time occupancy data?',
        followUp: 'Do you have sensors deployed or plan to deploy them?',
        options: ['yes have sensors', 'planning deployment', 'not needed'],
        scoreMap: { 'yes have sensors': 3, 'planning deployment': 2, 'not needed': 1 }
      },
      {
        id: 'workplace_servicenow_integration',
        product: 'workplace',
        category: 'Implementation & Professional Services',
        question: 'Do you need ServiceNow integration for service requests?',
        followUp: 'What ticketing system do you currently use?',
        options: ['yes ServiceNow', 'other system', 'no integration'],
        scoreMap: { 'yes ServiceNow': 3, 'other system': 2, 'no integration': 1 }
      },
      {
        id: 'workplace_floorplan_count',
        product: 'workplace',
        category: 'Implementation & Professional Services',
        question: 'How many building floorplans need to be created or imported?',
        followUp: 'Do you have CAD files or require drafting services?',
        options: ['over 20 floors', '5-20 floors', 'under 5 floors'],
        scoreMap: { 'over 20 floors': 3, '5-20 floors': 2, 'under 5 floors': 1 }
      },
      {
        id: 'workplace_mobile_app',
        product: 'workplace',
        category: 'Implementation & Professional Services',
        question: 'Do you need the Hummingbird mobile app for employee workspace booking?',
        followUp: 'What percentage of employees would use a mobile app?',
        options: ['yes critical', 'nice to have', 'not needed'],
        scoreMap: { 'yes critical': 3, 'nice to have': 2, 'not needed': 1 }
      },
      {
        id: 'workplace_data_migration',
        product: 'workplace',
        category: 'Implementation & Professional Services',
        question: 'Do you need data migration from existing workplace management systems?',
        followUp: 'What systems are you migrating from?',
        options: ['complex migration', 'simple migration', 'greenfield'],
        scoreMap: { 'complex migration': 3, 'simple migration': 2, 'greenfield': 1 }
      },
      {
        id: 'equipment_downtime',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'How many hours of unexpected equipment downtime do you experience monthly?',
        followUp: 'What production output is lost due to unexpected breakdowns?',
        options: ['under 10 hours', '10-30 hours', 'over 30 hours'],
        scoreMap: { 'under 10 hours': 1, '10-30 hours': 2, 'over 30 hours': 3 }
      },
      {
        id: 'preventive_maintenance_schedule',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'Do you have automated preventive maintenance scheduling in place?',
        followUp: 'How many breakdowns could be prevented with better PM scheduling?',
        options: ['yes automated', 'manual scheduling', 'reactive only'],
        scoreMap: { 'yes automated': 1, 'manual scheduling': 2, 'reactive only': 3 }
      },
      {
        id: 'maintenance_cost_per_asset',
        product: 'asset',
        category: 'Cost Savings',
        question: 'What is your average annual maintenance cost per critical asset?',
        followUp: 'How much could be saved through optimized work orders and inventory control?',
        options: ['under $5000', '$5000-$10000', 'over $10000'],
        scoreMap: { 'under $5000': 1, '$5000-$10000': 2, 'over $10000': 3 }
      },
      {
        id: 'work_order_optimization',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'Are your work orders and parts inventory optimized to minimize costs?',
        followUp: 'What unnecessary spending occurs from poor work order and inventory management?',
        options: ['yes optimized', 'partially', 'not optimized'],
        scoreMap: { 'yes optimized': 1, 'partially': 2, 'not optimized': 3 }
      },
      {
        id: 'asset_lifespan',
        product: 'asset',
        category: 'Cost Savings',
        question: 'Are your critical assets reaching their expected lifespan?',
        followUp: 'How much capital expense is wasted on premature equipment replacement?',
        options: ['yes meeting targets', 'mostly', 'frequent early failure'],
        scoreMap: { 'yes meeting targets': 1, 'mostly': 2, 'frequent early failure': 3 }
      },
      {
        id: 'condition_monitoring',
        product: 'asset',
        category: 'Cost Savings',
        question: 'Do you use condition monitoring to delay costly capital replacements?',
        followUp: 'How does condition monitoring help extend asset life and avoid premature replacement?',
        options: ['yes monitoring', 'planning to', 'no monitoring'],
        scoreMap: { 'yes monitoring': 1, 'planning to': 2, 'no monitoring': 3 }
      },
      {
        id: 'technician_productivity',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'What percentage of technician time is spent on actual maintenance vs paperwork?',
        followUp: 'How much productivity is lost to administrative tasks instead of repairs?',
        options: ['over 70% wrench time', '50-70%', 'under 50%'],
        scoreMap: { 'over 70% wrench time': 1, '50-70%': 2, 'under 50%': 3 }
      },
      {
        id: 'mobile_work_orders',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'Do technicians have mobile access to work orders, manuals, and asset history?',
        followUp: 'How much time is wasted by technicians returning to office for information?',
        options: ['yes mobile access', 'limited', 'no mobile access'],
        scoreMap: { 'yes mobile access': 1, 'limited': 2, 'no mobile access': 3 }
      },
      {
        id: 'compliance_audit_success',
        product: 'asset',
        category: 'Security & Compliance',
        question: 'What is your compliance audit success rate for maintenance and safety records?',
        followUp: 'What fines and legal costs could result from poor compliance documentation?',
        options: ['over 95%', '85-95%', 'under 85%'],
        scoreMap: { 'over 95%': 1, '85-95%': 2, 'under 85%': 3 }
      },
      {
        id: 'cmms_audit_trails',
        product: 'asset',
        category: 'Security & Compliance',
        question: 'Do you have CMMS audit trails to help avoid fines and legal costs?',
        followUp: 'What is the risk exposure from incomplete or missing maintenance records?',
        options: ['yes complete trails', 'partial records', 'no audit trails'],
        scoreMap: { 'yes complete trails': 1, 'partial records': 2, 'no audit trails': 3 }
      },
      {
        id: 'maintenance_analytics',
        product: 'asset',
        category: 'Decision-Making Clarity',
        question: 'Do you use analytics and reporting to optimize maintenance strategies?',
        followUp: 'What inefficient resource allocation occurs without data-driven decisions?',
        options: ['yes analytics driven', 'basic reporting', 'no analytics'],
        scoreMap: { 'yes analytics driven': 1, 'basic reporting': 2, 'no analytics': 3 }
      },
      {
        id: 'forecast_accuracy',
        product: 'asset',
        category: 'Decision-Making Clarity',
        question: 'How accurate are your maintenance cost and resource forecasts?',
        followUp: 'What budget overruns occur due to poor forecasting and planning?',
        options: ['very accurate', 'somewhat accurate', 'frequently off'],
        scoreMap: { 'very accurate': 1, 'somewhat accurate': 2, 'frequently off': 3 }
      },
      {
        id: 'parts_inventory_control',
        product: 'asset',
        category: 'Cost Savings',
        question: 'Do you have real-time visibility into parts inventory and stock levels?',
        followUp: 'How much is lost to emergency orders, stockouts, or excess inventory?',
        options: ['yes real time', 'manual tracking', 'poor visibility'],
        scoreMap: { 'yes real time': 1, 'manual tracking': 2, 'poor visibility': 3 }
      },
      {
        id: 'work_order_backlog',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'What is your typical work order backlog?',
        followUp: 'How does backlog impact equipment reliability and emergency response?',
        options: ['minimal backlog', 'manageable', 'significant backlog'],
        scoreMap: { 'minimal backlog': 1, 'manageable': 2, 'significant backlog': 3 }
      },
      {
        id: 'mean_time_to_repair',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'What is your average mean time to repair (MTTR) for critical assets?',
        followUp: 'How could faster repairs reduce downtime and improve production?',
        options: ['under 4 hours', '4-8 hours', 'over 8 hours'],
        scoreMap: { 'under 4 hours': 1, '4-8 hours': 2, 'over 8 hours': 3 }
      },
      {
        id: 'asset_criticality_ranking',
        product: 'asset',
        category: 'Decision-Making Clarity',
        question: 'Have you ranked assets by criticality to prioritize maintenance resources?',
        followUp: 'What inefficiencies result from treating all assets equally?',
        options: ['yes ranked', 'informal system', 'no ranking'],
        scoreMap: { 'yes ranked': 1, 'informal system': 2, 'no ranking': 3 }
      },
      {
        id: 'vendor_performance_tracking',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'Do you track vendor performance and warranty compliance?',
        followUp: 'How much money is left on the table from missed warranty claims?',
        options: ['yes tracked', 'manual tracking', 'not tracked'],
        scoreMap: { 'yes tracked': 1, 'manual tracking': 2, 'not tracked': 3 }
      },
      {
        id: 'maintenance_cost_trends',
        product: 'asset',
        category: 'Cost Savings',
        question: 'Can you identify maintenance cost trends to catch deteriorating assets early?',
        followUp: 'What costly failures could be prevented with better trend analysis?',
        options: ['yes trend analysis', 'limited visibility', 'no tracking'],
        scoreMap: { 'yes trend analysis': 1, 'limited visibility': 2, 'no tracking': 3 }
      },
      {
        id: 'emergency_maintenance_rate',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'What percentage of your maintenance is emergency vs planned?',
        followUp: 'How much more expensive is emergency maintenance than planned maintenance?',
        options: ['under 20% emergency', '20-40%', 'over 40%'],
        scoreMap: { 'under 20% emergency': 1, '20-40%': 2, 'over 40%': 3 }
      },
      {
        id: 'breakdown_frequency',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'How often do unexpected equipment breakdowns occur?',
        followUp: 'How confident are you in your occupancy data when making space planning decisions?',
        options: ['rarely', 'occasionally', 'frequently'],
        scoreMap: { 'rarely': 1, 'occasionally': 2, 'frequently': 3 }
      },
      {
        id: 'maintenance_overspending',
        product: 'asset',
        category: 'Cost Savings',
        question: 'Where are you overspending on maintenance per asset?',
        followUp: 'How are unauthorized access incidents being addressed to protect people and assets?',
        options: ['identified areas', 'some visibility', 'no visibility'],
        scoreMap: { 'identified areas': 1, 'some visibility': 2, 'no visibility': 3 }
      },
      {
        id: 'premature_failure_rate',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'Are you experiencing premature equipment failure compared to expected lifespan?',
        followUp: 'How does pre-registration improve visitor throughput and reduce front desk burden?',
        options: ['meeting expectations', 'some early failures', 'frequent early failures'],
        scoreMap: { 'meeting expectations': 1, 'some early failures': 2, 'frequent early failures': 3 }
      },
      {
        id: 'pm_scheduling_impact',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'How has automated preventive maintenance scheduling impacted breakdown frequency?',
        followUp: 'What is your process for handling flagged visitors and how does it support safety and compliance?',
        options: ['significant reduction', 'some improvement', 'no change or worse'],
        scoreMap: { 'significant reduction': 1, 'some improvement': 2, 'no change or worse': 3 }
      },
      {
        id: 'maintenance_forecast_savings',
        product: 'asset',
        category: 'Cost Savings',
        question: 'How accurate are your maintenance forecasts and what cost savings have you achieved?',
        followUp: 'How dynamic is your workplace traffic and how can you optimize services to match demand?',
        options: ['highly accurate with savings', 'somewhat accurate', 'inaccurate forecasts'],
        scoreMap: { 'highly accurate with savings': 1, 'somewhat accurate': 2, 'inaccurate forecasts': 3 }
      },
      {
        id: 'work_order_inventory_efficiency',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'How do optimized work orders and inventory control reduce unnecessary costs?',
        followUp: 'Where are you over or under-investing in space and how do costs inform decisions?',
        options: ['highly optimized', 'partially optimized', 'not optimized'],
        scoreMap: { 'highly optimized': 1, 'partially optimized': 2, 'not optimized': 3 }
      },
      {
        id: 'technician_admin_time',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'How much technician time is spent on actual repairs versus administrative tasks?',
        followUp: 'Where are assets underperforming and how can you extend lifespan to protect capital?',
        options: ['mostly repairs', 'balanced', 'too much admin'],
        scoreMap: { 'mostly repairs': 1, 'balanced': 2, 'too much admin': 3 }
      },
      {
        id: 'mobile_access_productivity',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'How does mobile access to work orders and manuals improve technician productivity?',
        followUp: 'How much of your technician time drives value and where can automation unlock productivity?',
        options: ['major improvement', 'some improvement', 'no mobile access'],
        scoreMap: { 'major improvement': 1, 'some improvement': 2, 'no mobile access': 3 }
      },
      {
        id: 'total_work_order_time',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'What is the total time spent processing and completing work orders?',
        followUp: 'How could automation reduce the time burden of work order management?',
        options: ['efficient process', 'moderate time', 'excessive time'],
        scoreMap: { 'efficient process': 1, 'moderate time': 2, 'excessive time': 3 }
      },
      {
        id: 'space_access_reliability',
        product: 'asset',
        category: 'Operational Efficiency',
        question: 'How reliably can employees access the spaces they need?',
        followUp: 'What is the impact on productivity when space access is unreliable?',
        options: ['very reliable', 'mostly reliable', 'unreliable'],
        scoreMap: { 'very reliable': 1, 'mostly reliable': 2, 'unreliable': 3 }
      },
      {
        id: 'asset_modules_needed',
        product: 'asset',
        category: 'Implementation & Professional Services',
        question: 'Which CMMS modules do you need: Assets, Work Orders, PM, Inventory, Inspections?',
        followUp: 'What are your top priorities for asset management?',
        options: ['need all modules', 'need 3-4 modules', 'need 1-2 modules'],
        scoreMap: { 'need all modules': 3, 'need 3-4 modules': 2, 'need 1-2 modules': 1 }
      },
      {
        id: 'asset_fleet_integration',
        product: 'asset',
        category: 'Implementation & Professional Services',
        question: 'Do you need fleet GPS integration (GEOTAB, GPS Insights, Zonar, etc.)?',
        followUp: 'What fleet management system do you currently use?',
        options: ['yes required', 'interested', 'not applicable'],
        scoreMap: { 'yes required': 3, 'interested': 2, 'not applicable': 1 }
      },
      {
        id: 'asset_equipment_brands',
        product: 'asset',
        category: 'Implementation & Professional Services',
        question: 'Do you need equipment manufacturer integration (John Deere, Volvo, VisionLink)?',
        followUp: 'What equipment brands make up your fleet?',
        options: ['yes multiple brands', 'yes single brand', 'not needed'],
        scoreMap: { 'yes multiple brands': 3, 'yes single brand': 2, 'not needed': 1 }
      },
      {
        id: 'asset_historical_data',
        product: 'asset',
        category: 'Implementation & Professional Services',
        question: 'Do you need historical work order data migrated from existing systems?',
        followUp: 'How many years of historical data do you want to preserve?',
        options: ['yes 3+ years', 'yes 1-2 years', 'fresh start'],
        scoreMap: { 'yes 3+ years': 3, 'yes 1-2 years': 2, 'fresh start': 1 }
      },
      {
        id: 'asset_custom_fields',
        product: 'asset',
        category: 'Implementation & Professional Services',
        question: 'Do you need extensive custom fields or data restructuring for your asset tracking?',
        followUp: 'What unique data points do you track that are not standard?',
        options: ['extensive customization', 'some customization', 'standard fields ok'],
        scoreMap: { 'extensive customization': 3, 'some customization': 2, 'standard fields ok': 1 }
      },
      {
        id: 'asset_api_requirements',
        product: 'asset',
        category: 'Implementation & Professional Services',
        question: 'Do you need API access for custom integrations with other business systems?',
        followUp: 'What systems need to integrate with your CMMS?',
        options: ['yes multiple systems', 'yes one system', 'not needed'],
        scoreMap: { 'yes multiple systems': 3, 'yes one system': 2, 'not needed': 1 }
      },
      {
        id: 'asset_training_scope',
        product: 'asset',
        category: 'Implementation & Professional Services',
        question: 'What is your asset management training requirement?',
        followUp: 'How many administrators, supervisors, and technicians need training?',
        options: ['comprehensive all roles', 'admin and supervisors', 'admin only'],
        scoreMap: { 'comprehensive all roles': 3, 'admin and supervisors': 2, 'admin only': 1 }
      },
      {
        id: 'asset_inventory_warehouses',
        product: 'asset',
        category: 'Implementation & Professional Services',
        question: 'How many inventory warehouses or stockrooms need to be configured?',
        followUp: 'How complex is your parts inventory management?',
        options: ['5+ warehouses', '2-4 warehouses', '0-1 warehouse'],
        scoreMap: { '5+ warehouses': 3, '2-4 warehouses': 2, '0-1 warehouse': 1 }
      },
      {
        id: 'sensor_usage',
        product: 'engage',
        category: 'Decision-Making Clarity',
        question: 'Are you using sensors to better understand occupancy?',
        followUp: 'What patterns are emerging in badge noncompliance, and what risks do they pose?',
        options: ['yes', 'sometimes', 'no'],
        scoreMap: { 'yes': 1, 'sometimes': 2, 'no': 3 }
      },
      {
        id: 'in_office_attendance',
        product: 'engage',
        category: 'Operational Efficiency',
        question: 'What is your employee in-office attendance rate compared to planned schedules?',
        followUp: 'How does low attendance affect collaboration quality and hybrid work policy adherence?',
        options: ['over 65%', '50-65%', 'under 50%'],
        scoreMap: { 'over 65%': 1, '50-65%': 2, 'under 50%': 3 }
      },
      {
        id: 'collaboration_days',
        product: 'engage',
        category: 'Employee Experience',
        question: 'How many days per month do teams collaborate in-person on average?',
        followUp: 'What is the impact of fragmented collaboration on project alignment and team effectiveness?',
        options: ['6-8 days', '3-5 days', 'under 3 days'],
        scoreMap: { '6-8 days': 1, '3-5 days': 2, 'under 3 days': 3 }
      },
      {
        id: 'booking_success',
        product: 'engage',
        category: 'Employee Experience',
        question: 'What percentage of room and desk bookings are successful without conflicts?',
        followUp: 'How do booking conflicts impact meeting effectiveness and employee frustration?',
        options: ['over 92%', '80-92%', 'under 80%'],
        scoreMap: { 'over 92%': 1, '80-92%': 2, 'under 80%': 3 }
      },
      {
        id: 'no_show_rate',
        product: 'engage',
        category: 'Operational Efficiency',
        question: 'What is your no-show rate for room and desk reservations?',
        followUp: 'How much space capacity could be reclaimed by reducing no-shows?',
        options: ['under 10%', '10-20%', 'over 20%'],
        scoreMap: { 'under 10%': 1, '10-20%': 2, 'over 20%': 3 }
      },
      {
        id: 'employee_satisfaction',
        product: 'engage',
        category: 'Employee Experience',
        question: 'What is your employee satisfaction score or NPS for workplace experience?',
        followUp: 'How does workplace experience influence retention, engagement, and overall performance?',
        options: ['high or positive', 'neutral', 'low or negative'],
        scoreMap: { 'high or positive': 1, 'neutral': 2, 'low or negative': 3 }
      },
      {
        id: 'booking_time',
        product: 'engage',
        category: 'Employee Experience',
        question: 'How long does it take employees on average to book a meeting room or desk?',
        followUp: 'How frictionless is your space booking process and what is the cost of inefficiency?',
        options: ['under 2 minutes', '2-5 minutes', 'over 5 minutes'],
        scoreMap: { 'under 2 minutes': 1, '2-5 minutes': 2, 'over 5 minutes': 3 }
      },
      {
        id: 'recurring_meeting_sync',
        product: 'engage',
        category: 'Operational Efficiency',
        question: 'What percentage of recurring meetings sync successfully without conflicts?',
        followUp: 'How do sync failures impact meeting continuity and administrative overhead?',
        options: ['over 95%', '85-95%', 'under 85%'],
        scoreMap: { 'over 95%': 1, '85-95%': 2, 'under 85%': 3 }
      },
      {
        id: 'booking_conflict_rate',
        product: 'engage',
        category: 'Operational Efficiency',
        question: 'What is your booking conflict rate across meeting rooms and desks?',
        followUp: 'What is the cost in lost productivity and employee frustration from booking conflicts?',
        options: ['under 5%', '5-10%', 'over 10%'],
        scoreMap: { 'under 5%': 1, '5-10%': 2, 'over 10%': 3 }
      },
      {
        id: 'desk_utilization',
        product: 'engage',
        category: 'Space Utilization',
        question: 'What is your current desk utilization rate?',
        followUp: 'How does underutilized desk space impact real estate costs and space planning?',
        options: ['60-75%', '45-60%', 'under 45%'],
        scoreMap: { '60-75%': 1, '45-60%': 2, 'under 45%': 3 }
      },
      {
        id: 'room_utilization',
        product: 'engage',
        category: 'Space Utilization',
        question: 'What is your meeting room utilization rate?',
        followUp: 'How could better utilization data inform portfolio optimization decisions?',
        options: ['60-75%', '50-60%', 'under 50%'],
        scoreMap: { '60-75%': 1, '50-60%': 2, 'under 50%': 3 }
      },
      {
        id: 'badge_integration',
        product: 'engage',
        category: 'Security & Compliance',
        question: 'Do you have badge integration for automated check-in and attendance tracking?',
        followUp: 'What is the risk of inaccurate attendance data for security and space planning?',
        options: ['yes fully integrated', 'partially', 'no integration'],
        scoreMap: { 'yes fully integrated': 1, 'partially': 2, 'no integration': 3 }
      },
      {
        id: 'space_reclaim',
        product: 'engage',
        category: 'Operational Efficiency',
        question: 'Can you automatically release and reclaim space from no-shows?',
        followUp: 'How much operational waste could be reduced by reclaiming unused reservations?',
        options: ['yes automated', 'manual process', 'no capability'],
        scoreMap: { 'yes automated': 1, 'manual process': 2, 'no capability': 3 }
      },
      {
        id: 'support_tickets',
        product: 'engage',
        category: 'Operational Efficiency',
        question: 'How many support tickets related to booking and authentication issues do you receive monthly?',
        followUp: 'What IT resources could be freed up by reducing booking-related support tickets?',
        options: ['minimal', 'moderate', 'high volume'],
        scoreMap: { 'minimal': 1, 'moderate': 2, 'high volume': 3 }
      },
      {
        id: 'consolidation_potential',
        product: 'engage',
        category: 'Space Utilization',
        question: 'Have you identified opportunities for space consolidation or lease savings?',
        followUp: 'What real estate cost savings could be achieved through better utilization data?',
        options: ['yes identified', 'exploring', 'no data available'],
        scoreMap: { 'yes identified': 1, 'exploring': 2, 'no data available': 3 }
      },
      {
        id: 'event_coordination',
        product: 'engage',
        category: 'Operational Efficiency',
        question: 'How much time does your team spend planning multi-room corporate events?',
        followUp: 'How could streamlined event coordination reduce planning time and errors?',
        options: ['under 4 hours', '4-8 hours', 'over 8 hours'],
        scoreMap: { 'under 4 hours': 1, '4-8 hours': 2, 'over 8 hours': 3 }
      },
      {
        id: 'calendar_integration',
        product: 'engage',
        category: 'Employee Experience',
        question: 'Do you have seamless integration with Microsoft 365 or Google Calendar?',
        followUp: 'How does lack of calendar integration impact booking efficiency and user adoption?',
        options: ['yes seamless', 'limited', 'no integration'],
        scoreMap: { 'yes seamless': 1, 'limited': 2, 'no integration': 3 }
      },
      {
        id: 'workweek_assignments',
        product: 'engage',
        category: 'Employee Experience',
        question: 'Do you use workweek assignments or team days to coordinate in-office presence?',
        followUp: 'How does lack of coordination impact collaboration quality and office attendance?',
        options: ['yes implemented', 'planning to', 'no'],
        scoreMap: { 'yes implemented': 1, 'planning to': 2, 'no': 3 }
      },
      {
        id: 'utilization_reporting',
        product: 'engage',
        category: 'Decision-Making Clarity',
        question: 'How quickly can you generate accurate utilization reports for leadership?',
        followUp: 'What strategic decisions are delayed by lack of real-time utilization data?',
        options: ['instantly', 'days or weeks', 'manual and slow'],
        scoreMap: { 'instantly': 1, 'days or weeks': 2, 'manual and slow': 3 }
      },
      {
        id: 'mobile_adoption',
        product: 'engage',
        category: 'Employee Experience',
        question: 'What percentage of employees use mobile apps for space booking and workplace services?',
        followUp: 'How does lack of mobile access impact employee experience and booking adoption?',
        options: ['over 50%', '25-50%', 'under 25%'],
        scoreMap: { 'over 50%': 1, '25-50%': 2, 'under 25%': 3 }
      },
      {
        id: 'engage_m365_integration',
        product: 'engage',
        category: 'Implementation & Professional Services',
        question: 'Do you need Microsoft 365 or Google Workspace integration for booking?',
        followUp: 'What collaboration platform does your organization use?',
        options: ['yes critical', 'preferred', 'not needed'],
        scoreMap: { 'yes critical': 3, 'preferred': 2, 'not needed': 1 }
      },
      {
        id: 'engage_hardware_deployment',
        product: 'engage',
        category: 'Implementation & Professional Services',
        question: 'Do you need meeting room screens, kiosks, or desk screens deployed?',
        followUp: 'How many locations and rooms need hardware?',
        options: ['50+ screens', '10-50 screens', 'under 10 screens'],
        scoreMap: { '50+ screens': 3, '10-50 screens': 2, 'under 10 screens': 1 }
      },
      {
        id: 'engage_sensor_deployment',
        product: 'engage',
        category: 'Implementation & Professional Services',
        question: 'Do you need occupancy sensors deployed for real-time space analytics?',
        followUp: 'How many rooms and desks need sensor coverage?',
        options: ['100+ sensors', '25-100 sensors', 'under 25 sensors'],
        scoreMap: { '100+ sensors': 3, '25-100 sensors': 2, 'under 25 sensors': 1 }
      },
      {
        id: 'engage_data_analytics',
        product: 'engage',
        category: 'Implementation & Professional Services',
        question: 'Do you need advanced data analytics and custom dashboards?',
        followUp: 'What specific metrics and KPIs does leadership need to see?',
        options: ['advanced analytics', 'standard reporting', 'basic metrics'],
        scoreMap: { 'advanced analytics': 3, 'standard reporting': 2, 'basic metrics': 1 }
      },
      {
        id: 'engage_floorplan_configuration',
        product: 'engage',
        category: 'Implementation & Professional Services',
        question: 'How many building floorplans need configuration for interactive booking?',
        followUp: 'Do you have CAD files or need drafting services?',
        options: ['20+ floors', '5-20 floors', 'under 5 floors'],
        scoreMap: { '20+ floors': 3, '5-20 floors': 2, 'under 5 floors': 1 }
      },
      {
        id: 'engage_visitor_integration',
        product: 'engage',
        category: 'Implementation & Professional Services',
        question: 'Do you need integration between employee booking and visitor management?',
        followUp: 'How important is unified visitor and employee experience?',
        options: ['yes critical', 'nice to have', 'separate systems ok'],
        scoreMap: { 'yes critical': 3, 'nice to have': 2, 'separate systems ok': 1 }
      },
      {
        id: 'engage_workplace_integration',
        product: 'engage',
        category: 'Implementation & Professional Services',
        question: 'Do you need integration with workplace management for moves and space planning?',
        followUp: 'How do you currently handle office moves and reconfigurations?',
        options: ['yes required', 'exploring', 'not needed'],
        scoreMap: { 'yes required': 3, 'exploring': 2, 'not needed': 1 }
      },
      {
        id: 'engage_training_scope',
        product: 'engage',
        category: 'Implementation & Professional Services',
        question: 'What training approach do you need for employee engagement rollout?',
        followUp: 'How many locations and employees need training?',
        options: ['train the trainer', 'admin training', 'self-service'],
        scoreMap: { 'train the trainer': 3, 'admin training': 2, 'self-service': 1 }
      }
    ];

    var talkingPoints = {
      'Operational Efficiency': {
        Low: 'Processes are stable, but there is room to streamline reporting and reduce manual effort. Consider automation opportunities to free up 10-15% of staff time. Solutions: Implement automated workflows, self-service options, and mobile work order access to boost productivity.',
        Medium: 'Efficiency gaps are visible‚Äîautomation and consolidation could free up significant time. Organizations typically see 20-30% reduction in manual tasks with proper systems. Value drivers: Reduced processing costs, faster service delivery, and improved technician wrench time. Solutions: Auto-routing, smart alternatives for bookings, and centralized work order management.',
        High: 'High inefficiency signals urgent opportunity‚Äîothers in your position reduced IT overhead by 15‚Äì20% and saved 30-40% on administrative costs. Value drivers: Eliminate manual entry, reduce support tickets by 20-30%, and optimize resource allocation. Solutions: Unified reservations, automated PM scheduling, SSO integration, and mobile access to work orders/manuals boost productivity significantly.'
      },
      'Employee Experience': {
        Low: 'Employees are generally satisfied, but booking friction may still cause frustration. Small improvements can boost retention and reduce time wasted by 5-10 minutes per booking. Solutions: Streamline booking flows, add wayfinding, and enable personalized workspace preferences.',
        Medium: 'Experience is mixed‚Äîstreamlining booking and reducing no-shows could lift satisfaction scores. Organizations see 15-20% improvement in employee engagement. Value drivers: Fair access to spaces, predictable collaboration days, reduced booking conflicts. Solutions: Workweek assignments, team days, unified mobile/web booking, and real-time host notifications create low-friction office experiences worth the commute.',
        High: 'High impact on experience‚Äîteams with similar challenges saw 20‚Äì25% EX/NPS improvement and reduced turnover risk. Value drivers: Frictionless workplace access, simplified reservations, better resource availability, reduced wait times. Solutions: Microsoft 365 add-in for seamless booking, self-service kiosks with QR codes (80-90% check-in under 2 minutes), branded pre-arrival emails, multi-language support, and smart alternatives when conflicts occur.'
      },
      'Security & Compliance': {
        Low: 'Compliance is strong, but monitoring accuracy can be tightened further. Proactive measures prevent future audit issues and liability exposure. Solutions: Strengthen audit trails, implement badge compliance tracking, and tighten visitor screening protocols.',
        Medium: 'Medium risk‚Äîbadge accuracy, visitor access, and tailgating incidents suggest gaps in workplace security. Addressing these reduces incident rates by 20-30%. Value drivers: Regulatory adherence, incident tracking, access governance. Solutions: Pre-registration with ID verification, watchlist screening (0.1-0.5% match rate), real-time access logs, and evacuation list automation improve safety and reduce liability.',
        High: 'High impact‚Äîsecurity lapses expose significant risk. Stronger compliance reduces liability by 30-50%, avoids fines, and improves safety. Value drivers: Audit readiness, policy enforcement, data protection, real-time alerts. Solutions: Automated NDA sign-off before QR codes, badge integration for check-in/check-out, government ID integration for regulated environments, CMMS audit trails to avoid fines, and emergency communication systems to reach all visitors during critical events.'
      },
      'Decision-Making Clarity': {
        Low: 'Data confidence is solid, but leaders may still want deeper visibility into utilization trends and portfolio performance. Solutions: Add real-time dashboards, trend analysis, and forecast accuracy tools for strategic planning.',
        Medium: 'Medium confidence‚Äîdecisions may be riskier than they need to be. Real-time analytics reduce forecasting errors by 25-35% and enable data-driven space planning. Value drivers: Centralized data, predictive insights, leadership visibility, trend identification. Solutions: Utilization & Trends dashboards with granular capacity ranges, weekday/floor-level views, People & Places KPIs, and analytics to optimize maintenance strategies.',
        High: 'High impact‚Äîleaders lack clarity needed for confident portfolio decisions. Accurate data enables 10-15% real estate savings and prevents costly over-investment. Value drivers: Real-time reporting, cross-team alignment, forecasting needs, condition monitoring. Solutions: Envision KPIs for portfolio optimization, scenario modeling (Baseline vs. Engage vs. Engage+Presence), sensor data for occupancy validation, and Advanced Analytics with filters by location, floor, and weekday enable evidence-based decision-making.'
      },
      'Decision Making Clarity': {
        Low: 'Data confidence is solid, but leaders may still want deeper visibility into utilization trends and portfolio performance. Solutions: Add real-time dashboards, trend analysis, and forecast accuracy tools for strategic planning.',
        Medium: 'Medium confidence‚Äîdecisions may be riskier than they need to be. Real-time analytics reduce forecasting errors by 25-35% and enable data-driven space planning. Value drivers: Centralized data, predictive insights, leadership visibility, trend identification. Solutions: Utilization & Trends dashboards with granular capacity ranges, weekday/floor-level views, People & Places KPIs, and analytics to optimize maintenance strategies.',
        High: 'High impact‚Äîleaders lack clarity needed for confident portfolio decisions. Accurate data enables 10-15% real estate savings and prevents costly over-investment. Value drivers: Real-time reporting, cross-team alignment, forecasting needs, condition monitoring. Solutions: Envision KPIs for portfolio optimization, scenario modeling (Baseline vs. Engage vs. Engage+Presence), sensor data for occupancy validation, and Advanced Analytics with filters by location, floor, and weekday enable evidence-based decision-making.'
      },
      'Space Utilization': {
        Low: 'Utilization is steady, but there may be hidden inefficiencies in portfolio costs. Sensor data and analytics can reveal 5-10% optimization opportunities. Solutions: Deploy sensors for actual vs. booked tracking, implement automated space release, and analyze desk attributes driving highest utilization.',
        Medium: 'Medium utilization suggests opportunity to reclaim space and reduce wasted spend. Organizations typically find 10-15% of space can be repurposed or consolidated. Value drivers: Accurate occupancy data, optimized room usage, desk utilization insights, right-sizing opportunities. Solutions: Automated check-in + space release to eliminate ghost bookings (30-50% reclaimed capacity), QR code alignment for accurate desk assignment, and weekday analytics to spot Tue-Thu peaks and flatten the mid-week hump.',
        High: 'High impact‚Äîorganizations often see 10‚Äì15% real estate savings with improved utilization, translating to $150-900 per seat/room monthly. Right-sizing prevents millions in unnecessary lease costs. Value drivers: Peak-time visibility, forecasting needs, portfolio optimization. Solutions: Badge integration for real attendance tracking, utilization dashboards by floor/location showing desk (45-65% baseline, target 60-75%) and room usage (50-70% baseline), dynamic reservations for hybrid work (60-70% adoption), and consolidation scenarios identifying 5-10% repurposing opportunities.'
      },
      'Cost Savings': {
        Low: 'Some cost avoidance potential exists through better space management and maintenance optimization. Focus on preventative strategies to reduce reactive spending. Solutions: Shift to preventative maintenance (target 70%+ vs reactive), optimize cleaning schedules by floor utilization, and implement energy alignment with occupancy.',
        Medium: 'Medium savings opportunity‚Äîconsolidation and automation could unlock significant cost reductions. Typical savings range from 15-25% on operational expenses. Value drivers: Labor reduction, space savings, technology consolidation, vendor reduction. Solutions: Automated service requests reduce avg cost from $15+ to under $10 per request, departmental chargebacks drive accountability, and optimized work orders minimize unnecessary labor and material costs.',
        High: 'High impact‚Äîportfolio optimization yields $150-$900 per seat/room monthly in avoided costs. Energy alignment saves 10-15%, preventative maintenance reduces emergency costs by 30-40%. Value drivers: Operational efficiency gains, reduced manual processing, condition monitoring delays capital replacements. Solutions: Identify underutilized areas for sublease or consolidation (every empty desk costs $33/sq ft annually), close under-occupied floors on low-usage days to save nightly cleaning costs, optimize HVAC/lighting with occupancy data (up to 15% energy savings), and implement real-time parts inventory to eliminate emergency orders and excess stock.'
      },
      'Implementation & Professional Services': {
        Low: 'Standard implementation with minimal customization. Basic configuration and self-service training materials will likely suffice. Estimated implementation: 4-8 weeks with standard modules and features.',
        Medium: 'Moderate complexity requiring some integrations, custom workflows, and structured training. Consider API consulting, badge/calendar integration, and administrator workshops. Estimated implementation: 8-16 weeks with multiple modules, 1-2 integrations, and moderate data migration.',
        High: 'Complex implementation requiring extensive customization, multiple integrations, hardware deployment, or significant data migration. Recommend comprehensive PS package including: custom integration consulting, extensive training (train-the-trainer), floorplan drafting services, advanced analytics setup, and dedicated implementation support. Estimated implementation: 16-24+ weeks with full module suite, 3+ integrations, hardware deployment, and complex business rules.'
      }
    };

    function initCounts() {
      var productTypes = ['visitor', 'workplace', 'asset', 'engage'];
      for (var i = 0; i < productTypes.length; i++) {
        var product = productTypes[i];
        var count = 0;
        for (var j = 0; j < questions.length; j++) {
          if (questions[j].product === product) {
            count++;
          }
        }
        document.getElementById(product + '-count').textContent = count + ' discovery questions';
      }
    }

    function selectProduct(product) {
      state.currentProduct = product;
      state.filteredQuestions = [];
      for (var i = 0; i < questions.length; i++) {
        if (questions[i].product === product) {
          state.filteredQuestions.push(questions[i]);
        }
      }
      state.currentStep = 0;
      state.answers = {};
      state.viewMode = 'step'; // Default to step-by-step view
      
      document.getElementById('productSelection').classList.add('hidden');
      document.getElementById('questionView').classList.remove('hidden');
      
      buildCategoryNavigation();
      renderQuestion();
    }
    
    function buildCategoryNavigation() {
      var categories = [];
      var categoryFirstQuestion = {};
      
      // Find unique categories and their first question index
      for (var i = 0; i < state.filteredQuestions.length; i++) {
        var category = state.filteredQuestions[i].category;
        if (categories.indexOf(category) === -1) {
          categories.push(category);
          categoryFirstQuestion[category] = i;
        }
      }
      
      var buttonContainer = document.getElementById('categoryButtons');
      buttonContainer.innerHTML = '';
      
      for (var i = 0; i < categories.length; i++) {
        var category = categories[i];
        var btn = document.createElement('button');
        btn.textContent = category;
        btn.style.cssText = 'padding: 8px 16px; background: white; border: 2px solid ' + products[state.currentProduct].color + '; color: ' + products[state.currentProduct].color + '; border-radius: 6px; font-size: 0.85rem; font-weight: 600; cursor: pointer; transition: all 0.2s;';
        btn.setAttribute('data-category-index', categoryFirstQuestion[category]);
        
        btn.onmouseover = function() {
          this.style.background = products[state.currentProduct].color;
          this.style.color = 'white';
        };
        btn.onmouseout = function() {
          this.style.background = 'white';
          this.style.color = products[state.currentProduct].color;
        };
        btn.onclick = function() {
          var targetIndex = parseInt(this.getAttribute('data-category-index'));
          jumpToQuestion(targetIndex);
        };
        
        buttonContainer.appendChild(btn);
      }
    }
    
    function jumpToQuestion(index) {
      state.currentStep = index;
      renderQuestion();
    }
    
    function toggleView() {
      if (state.viewMode === 'step') {
        state.viewMode = 'list';
        document.getElementById('stepByStepView').classList.add('hidden');
        document.getElementById('listView').classList.remove('hidden');
        document.getElementById('toggleViewBtn').textContent = 'Switch to Step-by-Step';
        renderListView();
      } else {
        state.viewMode = 'step';
        document.getElementById('listView').classList.add('hidden');
        document.getElementById('stepByStepView').classList.remove('hidden');
        document.getElementById('toggleViewBtn').textContent = 'Switch to List View';
        renderQuestion();
      }
    }
    
    function renderListView() {
      document.getElementById('listProductName').textContent = products[state.currentProduct].name;
      
      var container = document.getElementById('allQuestionsContainer');
      container.innerHTML = '';
      
      // Group questions by category
      var categorizedQuestions = {};
      for (var i = 0; i < state.filteredQuestions.length; i++) {
        var q = state.filteredQuestions[i];
        if (!categorizedQuestions[q.category]) {
          categorizedQuestions[q.category] = [];
        }
        categorizedQuestions[q.category].push({question: q, index: i});
      }
      
      var questionNumber = 1;
      
      // Render questions grouped by category
      for (var category in categorizedQuestions) {
        // Add category header
        var categoryHeader = document.createElement('div');
        categoryHeader.style.cssText = 'margin: 30px 0 20px 0; padding: 15px; background: #f8fafc; border-left: 4px solid ' + products[state.currentProduct].color + '; border-radius: 4px;';
        categoryHeader.innerHTML = '<div style="font-size: 0.85rem; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600;">Category</div><div style="font-size: 1.2rem; color: #1e293b; font-weight: 600; margin-top: 4px;">' + category + '</div>';
        container.appendChild(categoryHeader);
        
        var questions = categorizedQuestions[category];
        for (var j = 0; j < questions.length; j++) {
          var qData = questions[j];
          var q = qData.question;
          
          var item = document.createElement('div');
          item.className = 'question-list-item';
          
          var header = document.createElement('div');
          header.className = 'question-list-header';
          
          var number = document.createElement('div');
          number.className = 'question-list-number';
          number.textContent = questionNumber;
          number.style.background = products[state.currentProduct].color;
          
          var categoryBadge = document.createElement('div');
          categoryBadge.className = 'question-list-category';
          categoryBadge.textContent = q.category;
          
          header.appendChild(number);
          header.appendChild(categoryBadge);
          
          var title = document.createElement('div');
          title.className = 'question-list-title';
          title.textContent = q.question;
          
          item.appendChild(header);
          item.appendChild(title);
          
          if (q.followUp) {
            var followUp = document.createElement('div');
            followUp.className = 'question-list-followup';
            followUp.textContent = 'Follow-up: ' + q.followUp;
            item.appendChild(followUp);
          }
          
          var optionsContainer = document.createElement('div');
          optionsContainer.className = 'question-list-options';
          
          for (var k = 0; k < q.options.length; k++) {
            var option = q.options[k];
            var optionBtn = document.createElement('button');
            optionBtn.className = 'list-option-button';
            optionBtn.textContent = option;
            optionBtn.setAttribute('data-question-id', q.id);
            optionBtn.setAttribute('data-option', option);
            
            if (state.answers[q.id] === option) {
              optionBtn.classList.add('selected');
              optionBtn.style.background = products[state.currentProduct].color;
            }
            
            optionBtn.addEventListener('click', function() {
              var qId = this.getAttribute('data-question-id');
              var opt = this.getAttribute('data-option');
              selectAnswerList(qId, opt);
            });
            
            optionsContainer.appendChild(optionBtn);
          }
          
          item.appendChild(optionsContainer);
          container.appendChild(item);
          
          questionNumber++;
        }
      }
      
      updateSubmitButton();
    }
    
    function selectAnswerList(questionId, answer) {
      state.answers[questionId] = answer;
      renderListView();
    }
    
    function updateSubmitButton() {
      var answeredCount = 0;
      for (var i = 0; i < state.filteredQuestions.length; i++) {
        if (state.answers[state.filteredQuestions[i].id]) {
          answeredCount++;
        }
      }
      
      var submitBtn = document.getElementById('submitAllBtn');
      // Allow submission with any number of answers
      submitBtn.disabled = answeredCount === 0;
      submitBtn.style.background = answeredCount > 0 ? products[state.currentProduct].color : '#cbd5e1';
      
      // Update button text to show progress
      var totalQuestions = state.filteredQuestions.length;
      if (answeredCount === totalQuestions) {
        submitBtn.textContent = 'View Results ‚Üí';
      } else if (answeredCount > 0) {
        submitBtn.textContent = 'View Partial Results (' + answeredCount + '/' + totalQuestions + ' answered) ‚Üí';
      } else {
        submitBtn.textContent = 'Answer at least one question to view results';
      }
    }

    function renderQuestion() {
      var question = state.filteredQuestions[state.currentStep];
      var progress = ((state.currentStep + 1) / state.filteredQuestions.length) * 100;
      
      document.getElementById('progressText').textContent = 'Question ' + (state.currentStep + 1) + ' of ' + state.filteredQuestions.length;
      document.getElementById('productName').textContent = products[state.currentProduct].name;
      document.getElementById('progressFill').style.width = progress + '%';
      document.getElementById('progressFill').style.background = products[state.currentProduct].color;
      
      // Highlight current category button
      var categoryButtons = document.getElementById('categoryButtons').children;
      for (var i = 0; i < categoryButtons.length; i++) {
        var btn = categoryButtons[i];
        var btnIndex = parseInt(btn.getAttribute('data-category-index'));
        var nextCategoryIndex = i < categoryButtons.length - 1 ? parseInt(categoryButtons[i + 1].getAttribute('data-category-index')) : state.filteredQuestions.length;
        
        if (state.currentStep >= btnIndex && state.currentStep < nextCategoryIndex) {
          btn.style.background = products[state.currentProduct].color;
          btn.style.color = 'white';
          btn.style.fontWeight = '700';
        } else {
          btn.style.background = 'white';
          btn.style.color = products[state.currentProduct].color;
          btn.style.fontWeight = '600';
        }
      }
      
      // Show category header if category changed
      var previousCategory = state.currentStep > 0 ? state.filteredQuestions[state.currentStep - 1].category : null;
      var categoryHeader = document.getElementById('categoryHeader');
      var categoryHeaderTitle = document.getElementById('categoryHeaderTitle');
      
      if (previousCategory !== question.category) {
        categoryHeader.style.display = 'block';
        categoryHeaderTitle.textContent = question.category;
        categoryHeader.style.borderLeftColor = products[state.currentProduct].color;
      } else {
        categoryHeader.style.display = 'none';
      }
      
      document.getElementById('categoryBadge').textContent = question.category;
      document.getElementById('questionTitle').textContent = question.question;
      
      var followUpEl = document.getElementById('followUp');
      if (question.followUp) {
        followUpEl.textContent = 'Follow-up: ' + question.followUp;
        followUpEl.style.display = 'block';
      } else {
        followUpEl.style.display = 'none';
      }
      
      var optionsContainer = document.getElementById('optionsContainer');
      optionsContainer.innerHTML = '';
      
      for (var i = 0; i < question.options.length; i++) {
        var option = question.options[i];
        var button = document.createElement('button');
        button.className = 'option-button';
        button.textContent = option;
        button.setAttribute('data-option', option);
        button.addEventListener('click', function() {
          selectAnswer(question.id, this.getAttribute('data-option'));
        });
        
        if (state.answers[question.id] === option) {
          button.classList.add('selected');
          button.style.background = products[state.currentProduct].color;
        }
        
        optionsContainer.appendChild(button);
      }
      
      updateNavigation();
    }

    function selectAnswer(questionId, answer) {
      state.answers[questionId] = answer;
      renderQuestion();
    }

    function updateNavigation() {
      var question = state.filteredQuestions[state.currentStep];
      var hasAnswer = !!state.answers[question.id];
      
      document.getElementById('prevBtn').disabled = state.currentStep === 0;
      // Allow next/results button even if not answered
      document.getElementById('nextBtn').disabled = false;
      document.getElementById('nextBtn').style.background = hasAnswer ? products[state.currentProduct].color : '#94a3b8';
      
      var isLastQuestion = state.currentStep === state.filteredQuestions.length - 1;
      document.getElementById('nextBtn').innerHTML = isLastQuestion ? 'View Results ‚Üí' : 'Next ‚Üí';
    }

    function previousQuestion() {
      if (state.currentStep > 0) {
        state.currentStep--;
        renderQuestion();
      }
    }

    function nextQuestion() {
      if (state.currentStep < state.filteredQuestions.length - 1) {
        state.currentStep++;
        renderQuestion();
      } else {
        showResults();
      }
    }

    function calculateScores() {
      var scores = {};
      
      for (var i = 0; i < state.filteredQuestions.length; i++) {
        var q = state.filteredQuestions[i];
        var answer = state.answers[q.id];
        if (answer) {
          if (!scores[q.category]) {
            scores[q.category] = { total: 0, count: 0 };
          }
          scores[q.category].total += q.scoreMap[answer];
          scores[q.category].count += 1;
        }
      }
      
      var averages = {};
      for (var category in scores) {
        var avg = scores[category].total / scores[category].count;
        averages[category] = {
          score: avg,
          level: avg <= 1.5 ? 'Low' : avg <= 2.2 ? 'Medium' : 'High'
        };
      }
      
      return averages;
    }
    
    function generateRecommendations(categoryScores) {
      var recommendations = [];
      var currentProduct = state.currentProduct;
      
      // Recommendation logic based on category scores
      var highMediumCategories = [];
      for (var category in categoryScores) {
        if (categoryScores[category].level === 'High' || categoryScores[category].level === 'Medium') {
          highMediumCategories.push(category);
        }
      }
      
      // Visitor Management recommendations
      if (currentProduct === 'visitor') {
        if (highMediumCategories.indexOf('Operational Efficiency') !== -1) {
          recommendations.push({
            product: 'asset',
            productName: 'Asset Management',
            reason: 'High operational efficiency concerns suggest opportunities in maintenance workflows and work order optimization.',
            color: '#456ED6'
          });
          recommendations.push({
            product: 'workplace',
            productName: 'Workplace Management',
            reason: 'Operational efficiency pain points often extend to space management and service request workflows.',
            color: '#D48026'
          });
        }
        if (highMediumCategories.indexOf('Employee Experience') !== -1) {
          recommendations.push({
            product: 'engage',
            productName: 'Employee Engagement',
            reason: 'Employee experience issues with visitors suggest broader workplace experience challenges with booking and collaboration.',
            color: '#26A199'
          });
          recommendations.push({
            product: 'workplace',
            productName: 'Workplace Management',
            reason: 'Visitor experience issues often correlate with overall workspace satisfaction and booking friction.',
            color: '#D48026'
          });
        }
        if (highMediumCategories.indexOf('Security & Compliance') !== -1) {
          recommendations.push({
            product: 'workplace',
            productName: 'Workplace Management',
            reason: 'Security and compliance concerns extend to badge integration, occupancy tracking, and emergency protocols.',
            color: '#D48026'
          });
        }
      }
      
      // Workplace Management recommendations
      if (currentProduct === 'workplace') {
        if (highMediumCategories.indexOf('Operational Efficiency') !== -1) {
          recommendations.push({
            product: 'asset',
            productName: 'Asset Management',
            reason: 'Service request and maintenance inefficiencies indicate CMMS and work order optimization opportunities.',
            color: '#456ED6'
          });
        }
        if (highMediumCategories.indexOf('Cost Savings') !== -1) {
          recommendations.push({
            product: 'asset',
            productName: 'Asset Management',
            reason: 'Cost optimization goals align with preventative maintenance and asset lifecycle management.',
            color: '#456ED6'
          });
        }
        if (highMediumCategories.indexOf('Employee Experience') !== -1) {
          recommendations.push({
            product: 'engage',
            productName: 'Employee Engagement',
            reason: 'Workspace satisfaction issues suggest opportunities in hybrid work coordination and booking optimization.',
            color: '#26A199'
          });
          recommendations.push({
            product: 'visitor',
            productName: 'Visitor Management',
            reason: 'Employee experience challenges often include visitor hosting, meeting coordination, and front-desk operations.',
            color: '#904AB0'
          });
        }
        if (highMediumCategories.indexOf('Space Utilization') !== -1) {
          recommendations.push({
            product: 'engage',
            productName: 'Employee Engagement',
            reason: 'Utilization challenges require better booking systems, no-show reduction, and hybrid work coordination.',
            color: '#26A199'
          });
        }
      }
      
      // Asset Management recommendations
      if (currentProduct === 'asset') {
        if (highMediumCategories.indexOf('Operational Efficiency') !== -1) {
          recommendations.push({
            product: 'workplace',
            productName: 'Workplace Management',
            reason: 'Work order and service request inefficiencies extend to facilities management and space-related maintenance.',
            color: '#D48026'
          });
        }
        if (highMediumCategories.indexOf('Cost Savings') !== -1) {
          recommendations.push({
            product: 'workplace',
            productName: 'Workplace Management',
            reason: 'Cost optimization opportunities exist in space utilization, energy alignment, and real estate portfolio management.',
            color: '#D48026'
          });
        }
        if (highMediumCategories.indexOf('Decision-Making Clarity') !== -1) {
          recommendations.push({
            product: 'workplace',
            productName: 'Workplace Management',
            reason: 'Data and analytics gaps affect both asset and space planning decisions. Unified visibility drives better ROI.',
            color: '#D48026'
          });
        }
      }
      
      // Employee Engagement recommendations
      if (currentProduct === 'engage') {
        if (highMediumCategories.indexOf('Employee Experience') !== -1) {
          recommendations.push({
            product: 'visitor',
            productName: 'Visitor Management',
            reason: 'Employee experience includes hosting visitors, meeting coordination, and creating professional brand impressions.',
            color: '#904AB0'
          });
          recommendations.push({
            product: 'workplace',
            productName: 'Workplace Management',
            reason: 'Booking friction and workspace satisfaction require integrated facilities management and service request capabilities.',
            color: '#D48026'
          });
        }
        if (highMediumCategories.indexOf('Space Utilization') !== -1) {
          recommendations.push({
            product: 'workplace',
            productName: 'Workplace Management',
            reason: 'No-show rates, ghost bookings, and utilization gaps require comprehensive space analytics and portfolio optimization.',
            color: '#D48026'
          });
        }
        if (highMediumCategories.indexOf('Operational Efficiency') !== -1) {
          recommendations.push({
            product: 'workplace',
            productName: 'Workplace Management',
            reason: 'Support tickets, service requests, and maintenance workflows can be streamlined with unified facilities management.',
            color: '#D48026'
          });
          recommendations.push({
            product: 'asset',
            productName: 'Asset Management',
            reason: 'Operational efficiency extends to equipment maintenance, work order optimization, and technician productivity.',
            color: '#456ED6'
          });
        }
      }
      
      // Remove duplicates and limit to top 2-3 recommendations
      var uniqueRecs = [];
      var seen = {};
      for (var i = 0; i < recommendations.length; i++) {
        if (!seen[recommendations[i].product]) {
          uniqueRecs.push(recommendations[i]);
          seen[recommendations[i].product] = true;
        }
        if (uniqueRecs.length >= 3) break;
      }
      
      return uniqueRecs;
    }
    
    function generatePDF() {
      var jsPDF = window.jspdf.jsPDF;
      var doc = new jsPDF();
      
      var pageWidth = doc.internal.pageSize.getWidth();
      var pageHeight = doc.internal.pageSize.getHeight();
      var margin = 20;
      var yPos = margin;
      var lineHeight = 7;
      
      // Title
      doc.setFontSize(20);
      doc.setFont(undefined, 'bold');
      doc.text('Value-Driven Discovery Report', margin, yPos);
      yPos += 10;
      
      // Product name
      doc.setFontSize(12);
      doc.setFont(undefined, 'normal');
      doc.setTextColor(100);
      doc.text(products[state.currentProduct].name, margin, yPos);
      yPos += 10;
      
      // Date
      var today = new Date();
      doc.setFontSize(10);
      doc.text('Generated: ' + today.toLocaleDateString(), margin, yPos);
      yPos += 8;
      
      // Completion status
      var answeredCount = Object.keys(state.answers).length;
      var totalQuestions = state.filteredQuestions.length;
      var completionRate = Math.round((answeredCount / totalQuestions) * 100);
      
      doc.setFont(undefined, 'bold');
      doc.text('Completion: ' + completionRate + '% (' + answeredCount + ' of ' + totalQuestions + ' questions)', margin, yPos);
      yPos += 15;
      
      // Category Scores Section
      doc.setFontSize(16);
      doc.setFont(undefined, 'bold');
      doc.setTextColor(0);
      doc.text('Impact Assessment', margin, yPos);
      yPos += 10;
      
      var categoryScores = calculateScores();
      doc.setFontSize(10);
      doc.setFont(undefined, 'normal');
      
      for (var category in categoryScores) {
        var data = categoryScores[category];
        
        // Check if we need a new page
        if (yPos > pageHeight - 40) {
          doc.addPage();
          yPos = margin;
        }
        
        // Category name
        doc.setFont(undefined, 'bold');
        doc.text(category, margin, yPos);
        yPos += lineHeight;
        
        // Score and level
        doc.setFont(undefined, 'normal');
        doc.text('Score: ' + data.score.toFixed(2) + ' - ' + data.level + ' Impact', margin + 5, yPos);
        yPos += lineHeight;
        
        // Talking point
        var talkingPoint = 'No talking point available';
        if (talkingPoints[category] && talkingPoints[category][data.level]) {
          talkingPoint = talkingPoints[category][data.level];
        }
        
        doc.setFontSize(9);
        doc.setTextColor(80);
        var splitText = doc.splitTextToSize(talkingPoint, pageWidth - (margin * 2));
        doc.text(splitText, margin + 5, yPos);
        yPos += splitText.length * lineHeight + 5;
        
        doc.setFontSize(10);
        doc.setTextColor(0);
      }
      
      // Add new page for questions and answers
      doc.addPage();
      yPos = margin;
      
      doc.setFontSize(16);
      doc.setFont(undefined, 'bold');
      doc.text('Discovery Questions & Answers', margin, yPos);
      yPos += 15;
      
      doc.setFontSize(10);
      
      for (var i = 0; i < state.filteredQuestions.length; i++) {
        var q = state.filteredQuestions[i];
        var answer = state.answers[q.id];
        
        if (answer) {
          // Check if we need a new page
          if (yPos > pageHeight - 50) {
            doc.addPage();
            yPos = margin;
          }
          
          // Question number and category
          doc.setFont(undefined, 'bold');
          doc.setTextColor(0);
          doc.text('Q' + (i + 1) + ': ' + q.category, margin, yPos);
          yPos += lineHeight;
          
          // Question text
          doc.setFont(undefined, 'normal');
          doc.setFontSize(9);
          var questionText = doc.splitTextToSize(q.question, pageWidth - (margin * 2));
          doc.text(questionText, margin, yPos);
          yPos += questionText.length * lineHeight;
          
          // Answer
          doc.setFont(undefined, 'bold');
          doc.setTextColor(60, 130, 246); // Blue color for answer
          doc.text('Answer: ' + answer, margin, yPos);
          yPos += lineHeight + 5;
          
          doc.setTextColor(0);
          doc.setFontSize(10);
        }
      }
      
      // Add unanswered questions section if incomplete
      var unansweredCount = totalQuestions - answeredCount;
      if (unansweredCount > 0) {
        doc.addPage();
        yPos = margin;
        
        doc.setFontSize(14);
        doc.setFont(undefined, 'bold');
        doc.setTextColor(150, 150, 150);
        doc.text('Unanswered Questions (' + unansweredCount + ' remaining)', margin, yPos);
        yPos += 12;
        
        doc.setFontSize(9);
        doc.setFont(undefined, 'normal');
        doc.text('These questions can be addressed in future discovery conversations:', margin, yPos);
        yPos += 10;
        
        for (var i = 0; i < state.filteredQuestions.length; i++) {
          var q = state.filteredQuestions[i];
          if (!state.answers[q.id]) {
            if (yPos > pageHeight - 30) {
              doc.addPage();
              yPos = margin;
            }
            
            var questionLine = doc.splitTextToSize('‚Ä¢ ' + q.category + ': ' + q.question, pageWidth - (margin * 2 + 5));
            doc.text(questionLine, margin + 5, yPos);
            yPos += questionLine.length * lineHeight + 2;
          }
        }
      }
      
      // Save the PDF
      var filename = 'Discovery-Report-' + products[state.currentProduct].name.replace(/\s+/g, '-') + '-' + completionRate + 'pct-' + today.toISOString().split('T')[0] + '.pdf';
      doc.save(filename);
    }

    function showResults() {
      document.getElementById('questionView').classList.add('hidden');
      document.getElementById('resultsView').classList.remove('hidden');
      
      document.getElementById('resultsProduct').textContent = products[state.currentProduct].name;
      
      // Show completion status
      var answeredCount = Object.keys(state.answers).length;
      var totalQuestions = state.filteredQuestions.length;
      var completionRate = Math.round((answeredCount / totalQuestions) * 100);
      
      if (completionRate < 100) {
        var noticeDiv = document.createElement('div');
        noticeDiv.style.cssText = 'background: #fef3c7; border: 2px solid #f59e0b; border-radius: 8px; padding: 15px; margin-bottom: 20px;';
        noticeDiv.innerHTML = '<div style="display: flex; align-items: center; gap: 10px;"><span style="font-size: 1.5rem;">‚ö†Ô∏è</span><div><strong>Partial Discovery Results</strong><br><span style="color: #92400e; font-size: 0.9rem;">' + answeredCount + ' of ' + totalQuestions + ' questions answered (' + completionRate + '% complete). Scores are calculated based on answered questions only. Continue discovery in future conversations to refine results.</span></div></div>';
        
        var resultsView = document.getElementById('resultsView');
        resultsView.insertBefore(noticeDiv, resultsView.children[1]);
      }
      
      var resetBtn = document.getElementById('resetBtn');
      resetBtn.onclick = resetTool;
      
      var pdfBtn = document.getElementById('downloadPdfBtn');
      pdfBtn.onclick = generatePDF;
      
      var categoryScores = calculateScores();
      
      // Generate product recommendations
      var recommendations = generateRecommendations(categoryScores);
      
      var scoresGrid = document.getElementById('scoresGrid');
      scoresGrid.innerHTML = '';
      
      for (var category in categoryScores) {
        var data = categoryScores[category];
        var card = document.createElement('div');
        card.className = 'score-card ' + data.level.toLowerCase();
        
        var talkingPoint = 'No talking point available';
        if (talkingPoints[category] && talkingPoints[category][data.level]) {
          talkingPoint = talkingPoints[category][data.level];
        }
        
        card.innerHTML = '<div class="score-header"><h3>' + category + '</h3><span class="impact-badge">' + data.level + ' Impact</span></div><div class="score-value">üìä Score: ' + data.score.toFixed(2) + '</div><div class="talking-point">' + talkingPoint + '</div>';
        
        scoresGrid.appendChild(card);
      }
      
      // Display recommendations
      var recContainer = document.getElementById('recommendationsContainer');
      recContainer.innerHTML = '';
      
      if (recommendations.length > 0) {
        document.getElementById('recommendationsSection').style.display = 'block';
        
        for (var i = 0; i < recommendations.length; i++) {
          var rec = recommendations[i];
          var recCard = document.createElement('div');
          recCard.style.cssText = 'background: white; border-left: 4px solid ' + rec.color + '; padding: 20px; border-radius: 8px; margin-bottom: 15px; cursor: pointer; transition: all 0.2s;';
          recCard.onmouseover = function() { this.style.transform = 'translateX(5px)'; this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.1)'; };
          recCard.onmouseout = function() { this.style.transform = 'translateX(0)'; this.style.boxShadow = 'none'; };
          
          var recProduct = rec.product;
          recCard.onclick = function() {
            var prod = this.getAttribute('data-product');
            if (confirm('Start discovery for ' + products[prod].name + '?')) {
              selectProduct(prod);
            }
          };
          recCard.setAttribute('data-product', recProduct);
          
          recCard.innerHTML = '<div style="display: flex; align-items: center; gap: 15px;"><div style="width: 50px; height: 50px; background: ' + rec.color + '; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; font-weight: bold;">‚Üí</div><div style="flex: 1;"><div style="font-weight: 600; color: #1e293b; font-size: 1.1rem; margin-bottom: 5px;">' + rec.productName + '</div><div style="color: #64748b; font-size: 0.9rem; line-height: 1.5;">' + rec.reason + '</div></div></div>';
          
          recContainer.appendChild(recCard);
        }
      } else {
        document.getElementById('recommendationsSection').style.display = 'none';
      }
      
      var answersContainer = document.getElementById('answersContainer');
      answersContainer.innerHTML = '';
      
      for (var i = 0; i < state.filteredQuestions.length; i++) {
        var q = state.filteredQuestions[i];
        var answer = state.answers[q.id];
        if (answer) {
          var item = document.createElement('div');
          item.className = 'answer-item';
          item.innerHTML = '<div class="answer-question">' + q.question + '</div><div class="answer-value"><span class="checkmark">‚úì</span>' + answer + '</div>';
          answersContainer.appendChild(item);
        }
      }
    }

    function resetTool() {
      state.currentProduct = null;
      state.currentStep = 0;
      state.answers = {};
      state.filteredQuestions = [];
      
      document.getElementById('resultsView').classList.add('hidden');
      document.getElementById('productSelection').classList.remove('hidden');
    }

    document.addEventListener('DOMContentLoaded', function() {
      initCounts();
      
      document.getElementById('visitor-card').addEventListener('click', function() { selectProduct('visitor'); });
      document.getElementById('workplace-card').addEventListener('click', function() { selectProduct('workplace'); });
      document.getElementById('asset-card').addEventListener('click', function() { selectProduct('asset'); });
      document.getElementById('engage-card').addEventListener('click', function() { selectProduct('engage'); });
      
      document.getElementById('prevBtn').addEventListener('click', previousQuestion);
      document.getElementById('nextBtn').addEventListener('click', nextQuestion);
      document.getElementById('toggleViewBtn').addEventListener('click', toggleView);
      document.getElementById('submitAllBtn').addEventListener('click', showResults);
    });
  </script>
</body>
</html>
